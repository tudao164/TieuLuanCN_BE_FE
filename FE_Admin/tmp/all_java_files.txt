=== D:\TieuLuan\Do_An\FE_Admin\src\App.css ===

.now-showing-swiper .swiper-button-prev,
.now-showing-swiper .swiper-button-next {
  background: rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  width: 40px !important;
  height: 40px !important;
  display: flex;
  align-items: center;
  justify-content: center;
  top: 50%;
  transform: translateY(-50%);
}

.now-showing-swiper .swiper-button-prev {
  left: 10px;
}

.now-showing-swiper .swiper-button-next {
  right: 10px;
}

.now-showing-swiper .swiper-pagination-bullet {
  width: 10px;
  height: 10px;
  background: #fff;
  opacity: 0.5;
}

.now-showing-swiper .swiper-pagination-bullet-active {
  opacity: 1;
  background: #fbbf24;
}

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\App.jsx ===

import { BrowserRouter, Routes, Route } from "react-router-dom";
import Home from "./pages/Home/Home";             // Trang chủ khi chưa login
import Login from "./pages/Auth/Login";
import Register from "./pages/Auth/Login";
import ForgotPassword from "./pages/Auth/ForgotPassword";
import Profile from "./pages/Auth/Profile";
import VerifyOTP from "./pages/Auth/Profile";
import ResetPassword from "./pages/Auth/ResetPassword";
// Trang chủ sau khi login
import Header from "./components/layout/Header";
import MovieList from "./components/Movie/MovieManagement";
import InputField from "./components/Login/InputField";



function App() {
  return (

    <BrowserRouter>
      <Routes>
        {/* Trang chủ (guest) */}
        <Route path="/" element={<Home />} />
        <Route path="/header" element={<Header></Header>}></Route>
        <Route path="/movielist" element={<MovieList></MovieList>}></Route>

        {/* Auth */}
        <Route path="/login" element={<Login />} />
        <Route path="/input-file" element={<InputField></InputField>} />
        <Route path="/register" element={<Register />} />
        <Route path="/forgot-password" element={<ForgotPassword />} />
        <Route path="/verify-otp" element={<VerifyOTP />} />
        <Route path="/reset-password" element={<ResetPassword />} />

        {/* User */}

        <Route path="/profile" element={<Profile />} />


        {/* Products */}

      </Routes>
    </BrowserRouter>

  );
}

export default App;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\index.css ===

@import "tailwindcss";

/* Custom utilities */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\main.jsx ===

import { StrictMode } from "react";
import { createRoot } from "react-dom/client";
import { Provider } from "react-redux";
import { store } from "./app/store";   // import store bạn đã tạo
import "./index.css";
import App from "./App.jsx";

createRoot(document.getElementById("root")).render(
  <StrictMode>
    <Provider store={store}>
      <App />
    </Provider>
  </StrictMode>
);


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\app\store.js ===

import { configureStore } from "@reduxjs/toolkit";
import authReducer from "../features/authSlice";

export const store = configureStore({
  reducer: {
    auth: authReducer,
  },
});


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\assets\react.svg ===

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="35.93" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 228"><path fill="#00D8FF" d="M210.483 73.824a171.49 171.49 0 0 0-8.24-2.597c.465-1.9.893-3.777 1.273-5.621c6.238-30.281 2.16-54.676-11.769-62.708c-13.355-7.7-35.196.329-57.254 19.526a171.23 171.23 0 0 0-6.375 5.848a155.866 155.866 0 0 0-4.241-3.917C100.759 3.829 77.587-4.822 63.673 3.233C50.33 10.957 46.379 33.89 51.995 62.588a170.974 170.974 0 0 0 1.892 8.48c-3.28.932-6.445 1.924-9.474 2.98C17.309 83.498 0 98.307 0 113.668c0 15.865 18.582 31.778 46.812 41.427a145.52 145.52 0 0 0 6.921 2.165a167.467 167.467 0 0 0-2.01 9.138c-5.354 28.2-1.173 50.591 12.134 58.266c13.744 7.926 36.812-.22 59.273-19.855a145.567 145.567 0 0 0 5.342-4.923a168.064 168.064 0 0 0 6.92 6.314c21.758 18.722 43.246 26.282 56.54 18.586c13.731-7.949 18.194-32.003 12.4-61.268a145.016 145.016 0 0 0-1.535-6.842c1.62-.48 3.21-.974 4.76-1.488c29.348-9.723 48.443-25.443 48.443-41.52c0-15.417-17.868-30.326-45.517-39.844Zm-6.365 70.984c-1.4.463-2.836.91-4.3 1.345c-3.24-10.257-7.612-21.163-12.963-32.432c5.106-11 9.31-21.767 12.459-31.957c2.619.758 5.16 1.557 7.61 2.4c23.69 8.156 38.14 20.213 38.14 29.504c0 9.896-15.606 22.743-40.946 31.14Zm-10.514 20.834c2.562 12.94 2.927 24.64 1.23 33.787c-1.524 8.219-4.59 13.698-8.382 15.893c-8.067 4.67-25.32-1.4-43.927-17.412a156.726 156.726 0 0 1-6.437-5.87c7.214-7.889 14.423-17.06 21.459-27.246c12.376-1.098 24.068-2.894 34.671-5.345a134.17 134.17 0 0 1 1.386 6.193ZM87.276 214.515c-7.882 2.783-14.16 2.863-17.955.675c-8.075-4.657-11.432-22.636-6.853-46.752a156.923 156.923 0 0 1 1.869-8.499c10.486 2.32 22.093 3.988 34.498 4.994c7.084 9.967 14.501 19.128 21.976 27.15a134.668 134.668 0 0 1-4.877 4.492c-9.933 8.682-19.886 14.842-28.658 17.94ZM50.35 144.747c-12.483-4.267-22.792-9.812-29.858-15.863c-6.35-5.437-9.555-10.836-9.555-15.216c0-9.322 13.897-21.212 37.076-29.293c2.813-.98 5.757-1.905 8.812-2.773c3.204 10.42 7.406 21.315 12.477 32.332c-5.137 11.18-9.399 22.249-12.634 32.792a134.718 134.718 0 0 1-6.318-1.979Zm12.378-84.26c-4.811-24.587-1.616-43.134 6.425-47.789c8.564-4.958 27.502 2.111 47.463 19.835a144.318 144.318 0 0 1 3.841 3.545c-7.438 7.987-14.787 17.08-21.808 26.988c-12.04 1.116-23.565 2.908-34.161 5.309a160.342 160.342 0 0 1-1.76-7.887Zm110.427 27.268a347.8 347.8 0 0 0-7.785-12.803c8.168 1.033 15.994 2.404 23.343 4.08c-2.206 7.072-4.956 14.465-8.193 22.045a381.151 381.151 0 0 0-7.365-13.322Zm-45.032-43.861c5.044 5.465 10.096 11.566 15.065 18.186a322.04 322.04 0 0 0-30.257-.006c4.974-6.559 10.069-12.652 15.192-18.18ZM82.802 87.83a323.167 323.167 0 0 0-7.227 13.238c-3.184-7.553-5.909-14.98-8.134-22.152c7.304-1.634 15.093-2.97 23.209-3.984a321.524 321.524 0 0 0-7.848 12.897Zm8.081 65.352c-8.385-.936-16.291-2.203-23.593-3.793c2.26-7.3 5.045-14.885 8.298-22.6a321.187 321.187 0 0 0 7.257 13.246c2.594 4.48 5.28 8.868 8.038 13.147Zm37.542 31.03c-5.184-5.592-10.354-11.779-15.403-18.433c4.902.192 9.899.29 14.978.29c5.218 0 10.376-.117 15.453-.343c-4.985 6.774-10.018 12.97-15.028 18.486Zm52.198-57.817c3.422 7.8 6.306 15.345 8.596 22.52c-7.422 1.694-15.436 3.058-23.88 4.071a382.417 382.417 0 0 0 7.859-13.026a347.403 347.403 0 0 0 7.425-13.565Zm-16.898 8.101a358.557 358.557 0 0 1-12.281 19.815a329.4 329.4 0 0 1-23.444.823c-7.967 0-15.716-.248-23.178-.732a310.202 310.202 0 0 1-12.513-19.846h.001a307.41 307.41 0 0 1-10.923-20.627a310.278 310.278 0 0 1 10.89-20.637l-.001.001a307.318 307.318 0 0 1 12.413-19.761c7.613-.576 15.42-.876 23.31-.876H128c7.926 0 15.743.303 23.354.883a329.357 329.357 0 0 1 12.335 19.695a358.489 358.489 0 0 1 11.036 20.54a329.472 329.472 0 0 1-11 20.722Zm22.56-122.124c8.572 4.944 11.906 24.881 6.52 51.026c-.344 1.668-.73 3.367-1.15 5.09c-10.622-2.452-22.155-4.275-34.23-5.408c-7.034-10.017-14.323-19.124-21.64-27.008a160.789 160.789 0 0 1 5.888-5.4c18.9-16.447 36.564-22.941 44.612-18.3ZM128 90.808c12.625 0 22.86 10.235 22.86 22.86s-10.235 22.86-22.86 22.86s-22.86-10.235-22.86-22.86s10.235-22.86 22.86-22.86Z"></path></svg>

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\assets\Image\logo.png ===

*** Lỗi khi đọc file: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte ***


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\assets\Image\ticket.png ===

*** Lỗi khi đọc file: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte ***


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\components\Pagination.jsx ===

import React from 'react';

const Pagination = ({ pagination, onPageChange }) => {
  console.log('Pagination data:', pagination);
  
  if (!pagination || pagination.totalPages <= 1) {
    return null;
  }

  const { page: currentPage, totalPages, hasNext, hasPrev } = pagination;

  // Tạo danh sách các trang để hiển thị
  const getPageNumbers = () => {
    const delta = 2; // Số trang hiển thị ở mỗi bên của trang hiện tại
    const range = [];
    const rangeWithDots = [];

    // Luôn hiển thị trang đầu
    range.push(1);

    // Tính toán khoảng trang cần hiển thị xung quanh trang hiện tại
    for (let i = Math.max(2, currentPage - delta); 
         i <= Math.min(totalPages - 1, currentPage + delta); 
         i++) {
      range.push(i);
    }

    // Luôn hiển thị trang cuối (nếu totalPages > 1)
    if (totalPages > 1) {
      range.push(totalPages);
    }

    // Thêm dấu "..." nếu cần
    let l = range[0];
    for (let i of range) {
      if (l + 1 < i) {
        rangeWithDots.push('...');
      }
      rangeWithDots.push(i);
      l = i;
    }

    return rangeWithDots;
  };

  const pageNumbers = getPageNumbers();

  return (
    <div className="flex justify-center items-center gap-2 mt-6">
      {/* Previous button */}
      <button
        disabled={!hasPrev || currentPage <= 1}
        onClick={() => {
          console.log('Previous button clicked, current page:', currentPage);
          onPageChange(currentPage - 1);
        }}
        className={`px-3 py-2 border rounded-lg transition-colors ${
          !hasPrev || currentPage <= 1
            ? 'opacity-50 cursor-not-allowed bg-gray-100 text-gray-400'
            : 'hover:bg-gray-50 bg-white text-gray-700 cursor-pointer'
        }`}
      >
        ← Trước
      </button>

      {/* Page numbers */}
      {pageNumbers.map((number, index) => (
        number === '...' ? (
          <span key={`dots-${index}`} className="px-2 py-2 text-gray-500">
            ...
          </span>
        ) : (
          <button
            key={number}
            onClick={() => {
              console.log('Page number clicked:', number);
              onPageChange(number);
            }}
            className={`px-3 py-2 border rounded-lg transition-colors cursor-pointer ${
              currentPage === number
                ? 'bg-green-600 text-white border-green-600'
                : 'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'
            }`}
          >
            {number}
          </button>
        )
      ))}

      {/* Next button */}
      <button
        disabled={!hasNext || currentPage >= totalPages}
        onClick={() => {
          console.log('Next button clicked, current page:', currentPage);
          onPageChange(currentPage + 1);
        }}
        className={`px-3 py-2 border rounded-lg transition-colors ${
          !hasNext || currentPage >= totalPages
            ? 'opacity-50 cursor-not-allowed bg-gray-100 text-gray-400'
            : 'hover:bg-gray-50 bg-white text-gray-700 cursor-pointer'
        }`}
      >
        Sau →
      </button>

      {/* Page info */}
      <div className="ml-4 text-sm text-gray-600">
        Trang {currentPage} / {totalPages}
      </div>
    </div>
  );
};

export default Pagination;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\components\Combo\Card.jsx ===


import { motion } from "framer-motion";

export function Card({ children, className = "" }) {
    return (
        <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.3 }}
            className={`group ${className}`}
        >
            <div className="shadow-lg hover:shadow-xl transition rounded-2xl overflow-hidden bg-[#0B122E] border border-white/10">
                {children}
            </div>
        </motion.div>
    );
}

export function CardContent({ children, className = "" }) {
    return <div className={`p-5 space-y-3 text-center ${className}`}>{children}</div>;
}

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\components\Combo\ComboCard.jsx ===

// src/components/Combo/ComboCard.jsx
import { useState } from "react";
import { Card, CardContent } from "./Card";   // ← sửa import

export default function ComboCard({ combo, onQuantityChange }) {
    const [quantity, setQuantity] = useState(0);

    const handleIncrease = () => {
        const newQty = quantity + 1;
        setQuantity(newQty);
        onQuantityChange(combo.comboID, newQty);
    };

    const handleDecrease = () => {
        const newQty = Math.max(quantity - 1, 0);
        setQuantity(newQty);
        onQuantityChange(combo.comboID, newQty);
    };

    return (
        <Card>   {/* có thể thêm key={combo.comboID} nếu dùng độc lập */}
            {/* <img ... /> */}
            <CardContent>
                <h2 className="text-xl font-semibold">{combo.nameCombo}</h2>
                <p className="text-gray-300">{combo.description}</p>
                <p className="font-bold text-purple-400 text-lg">
                    {(combo.price || 0).toLocaleString()} đ
                </p>

                <button
                    className="w-full mt-3 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold rounded-lg hover:from-purple-700 hover:to-pink-700 transition transform hover:scale-105"
                    onClick={() => alert(`Bạn chọn combo: ${combo.nameCombo}`)}
                >
                    Chọn Combo
                </button>

                <div className="flex justify-center items-center gap-4 mt-4">
                    <button
                        onClick={handleDecrease}
                        disabled={quantity === 0}
                        className="px-4 py-2 bg-white/20 rounded-lg text-xl hover:bg-white/30 transition disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                        −
                    </button>
                    <span className="text-xl font-bold w-12 text-center">{quantity}</span>
                    <button
                        onClick={handleIncrease}
                        className="px-4 py-2 bg-orange-500 text-white rounded-lg text-xl hover:bg-orange-600 transition font-bold"
                    >
                        +
                    </button>
                </div>
            </CardContent>
        </Card>
    );
}

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\components\Dashboard\Dashboard.jsx ===

// components/Dashboard/Dashboard.jsx
import React from 'react';
import { Users, Film, Sofa, DollarSign, TrendingUp, Calendar } from 'lucide-react';

const Dashboard = () => {
    const stats = [
        {
            title: 'Tổng Phim',
            value: '45',
            icon: Film,
            color: 'bg-blue-500',
            change: '+12%',
            trend: 'up'
        },
        {
            title: 'Tổng Phòng',
            value: '8',
            icon: Sofa,
            color: 'bg-green-500',
            change: '+2',
            trend: 'up'
        },
        {
            title: 'Doanh Thu Hôm Nay',
            value: '12.5M',
            icon: DollarSign,
            color: 'bg-purple-500',
            change: '+8.5%',
            trend: 'up'
        },
        {
            title: 'Người Dùng',
            value: '1,234',
            icon: Users,
            color: 'bg-orange-500',
            change: '+5.2%',
            trend: 'up'
        }
    ];

    const recentActivities = [
        { id: 1, action: 'Phim mới được thêm', target: 'Avengers: Endgame', time: '5 phút trước' },
        { id: 2, action: 'Phòng được cập nhật', target: 'Phòng IMAX 1', time: '1 giờ trước' },
        { id: 3, action: 'Suất chiếu mới', target: '22:00 - Spider-Man', time: '2 giờ trước' },
        { id: 4, action: 'Người dùng mới đăng ký', target: 'Nguyễn Văn A', time: '3 giờ trước' },
    ];

    return (
        <div className="p-6">
            <div className="mb-8">
                <h1 className="text-3xl font-bold text-gray-800">Dashboard</h1>
                <p className="text-gray-600">Tổng quan về hệ thống rạp chiếu phim</p>
            </div>

            {/* Stats Grid */}
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                {stats.map((stat, index) => {
                    const Icon = stat.icon;
                    return (
                        <div key={index} className="bg-white rounded-lg shadow-lg p-6 border border-gray-200">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-sm font-medium text-gray-600">{stat.title}</p>
                                    <p className="text-2xl font-bold text-gray-800 mt-1">{stat.value}</p>
                                    <p className={`text-sm mt-1 ${stat.trend === 'up' ? 'text-green-500' : 'text-red-500'}`}>
                                        {stat.change} so với tháng trước
                                    </p>
                                </div>
                                <div className={`p-3 rounded-full ${stat.color} text-white`}>
                                    <Icon className="w-6 h-6" />
                                </div>
                            </div>
                        </div>
                    );
                })}
            </div>

            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                {/* Recent Activities */}
                <div className="bg-white rounded-lg shadow-lg p-6 border border-gray-200">
                    <h3 className="text-lg font-semibold text-gray-800 mb-4">Hoạt Động Gần Đây</h3>
                    <div className="space-y-4">
                        {recentActivities.map((activity) => (
                            <div key={activity.id} className="flex items-start space-x-3 p-3 hover:bg-gray-50 rounded-lg">
                                <div className="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                                <div className="flex-1">
                                    <p className="text-sm font-medium text-gray-800">
                                        {activity.action} <span className="text-purple-600">"{activity.target}"</span>
                                    </p>
                                    <p className="text-xs text-gray-500 mt-1">{activity.time}</p>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>

                {/* Quick Actions */}
                <div className="bg-white rounded-lg shadow-lg p-6 border border-gray-200">
                    <h3 className="text-lg font-semibold text-gray-800 mb-4">Thao Tác Nhanh</h3>
                    <div className="grid grid-cols-2 gap-4">
                        <button className="p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors text-center">
                            <Film className="w-8 h-8 text-blue-600 mx-auto mb-2" />
                            <span className="text-sm font-medium text-blue-800">Thêm Phim Mới</span>
                        </button>
                        <button className="p-4 bg-green-50 rounded-lg hover:bg-green-100 transition-colors text-center">
                            <Sofa className="w-8 h-8 text-green-600 mx-auto mb-2" />
                            <span className="text-sm font-medium text-green-800">Tạo Phòng Mới</span>
                        </button>
                        <button className="p-4 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors text-center">
                            <Calendar className="w-8 h-8 text-purple-600 mx-auto mb-2" />
                            <span className="text-sm font-medium text-purple-800">Lịch Chiếu</span>
                        </button>
                        <button className="p-4 bg-orange-50 rounded-lg hover:bg-orange-100 transition-colors text-center">
                            <Users className="w-8 h-8 text-orange-600 mx-auto mb-2" />
                            <span className="text-sm font-medium text-orange-800">Quản Lý User</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    );
};

export default Dashboard;

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\components\layout\Footer.jsx ===

// components/layout/Footer.jsx
import React from 'react';

const Footer = () => {
    return (
        <footer className="bg-gray-800 text-white py-4 mt-auto">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <p>&copy; 2024 Cinema Management System. All rights reserved.</p>
            </div>
        </footer>
    );
};

export default Footer;

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\components\layout\Header.jsx ===

// components/layout/Header.jsx
import React, { useState } from 'react';
import { LogOut, User, Menu, X, Film, Sofa, Home, Settings } from 'lucide-react';

const Header = ({ user, handleLogout, onMenuToggle, isSidebarOpen }) => {
    return (
        <header className="bg-gradient-to-r from-purple-600 to-pink-600 shadow-lg">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div className="flex justify-between items-center h-16">
                    {/* Left side - Logo and Menu button */}
                    <div className="flex items-center">
                        <button
                            onClick={onMenuToggle}
                            className="p-2 rounded-md text-white hover:bg-white/20 transition-colors"
                        >
                            {isSidebarOpen ? <X className="w-6 h-6" /> : <Menu className="w-6 h-6" />}
                        </button>
                        <div className="ml-4 flex items-center">
                            <Film className="w-8 h-8 text-white" />
                            <span className="ml-2 text-white text-xl font-bold">Cinema Admin</span>
                        </div>
                    </div>

                    {/* Right side - User info and logout */}
                    <div className="flex items-center space-x-4">
                        <div className="flex items-center text-white">
                            <User className="w-5 h-5 mr-2" />
                            <span className="font-medium">{user?.name || 'Admin'}</span>
                        </div>
                        <button
                            onClick={handleLogout}
                            className="flex items-center px-4 py-2 text-white bg-white/20 rounded-lg hover:bg-white/30 transition-colors"
                        >
                            <LogOut className="w-4 h-4 mr-2" />
                            Đăng xuất
                        </button>
                    </div>
                </div>
            </div>
        </header>
    );
};

export default Header;

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\components\layout\Sidebar.jsx ===

// components/layout/Sidebar.jsx
import React from 'react';
import { Film, Sofa, Home, Settings, Users, Ticket, BarChart3 } from 'lucide-react';

const Sidebar = ({ activeTab, setActiveTab, isOpen }) => {
    const menuItems = [
        { id: 'dashboard', label: 'Dashboard', icon: Home },
        { id: 'movies', label: 'Quản Lý Phim', icon: Film },
        { id: 'rooms', label: 'Quản Lý Phòng & Ghế', icon: Sofa },
        { id: 'showtimes', label: 'Lịch Chiếu', icon: Ticket },
        { id: 'users', label: 'Quản Lý Người Dùng', icon: Users },
        { id: 'reports', label: 'Báo Cáo & Thống Kê', icon: BarChart3 },
        { id: 'settings', label: 'Cài Đặt', icon: Settings },
    ];

    return (
        <div className={`
            bg-white shadow-lg transform transition-all duration-300 ease-in-out
            ${isOpen ? 'w-64 translate-x-0' : 'w-0 -translate-x-full'}
            lg:w-64 lg:translate-x-0
            fixed lg:static top-0 left-0 h-full z-40 overflow-y-auto
        `}>
            <div className="p-6">
                <div className="mb-8">
                    <h2 className="text-xl font-bold text-gray-800">Admin Panel</h2>
                </div>

                <nav className="space-y-2">
                    {menuItems.map((item) => {
                        const Icon = item.icon;
                        return (
                            <button
                                key={item.id}
                                onClick={() => setActiveTab(item.id)}
                                className={`
                                    w-full flex items-center px-4 py-3 text-left rounded-lg transition-all duration-200
                                    ${activeTab === item.id
                                        ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg'
                                        : 'text-gray-600 hover:bg-gray-100 hover:text-gray-900'
                                    }
                                `}
                            >
                                <Icon className="w-5 h-5 mr-3" />
                                <span className="font-medium">{item.label}</span>
                            </button>
                        );
                    })}
                </nav>
            </div>
        </div>
    );
};

export default Sidebar;

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\components\Login\InputField.jsx ===


import React from "react";

const InputField = ({
    label,
    type = "text",
    name,
    value,
    onChange,
    placeholder = "",
    required = false,
    autoFocus = false,
    className = "",
}) => {
    return (
        <div className={`mb-4 ${className}`}>
            {label && (
                <label className="block text-sm font-medium text-gray-700 mb-1">
                    {label} {required && <span className="text-red-500">*</span>}
                </label>
            )}
            <input
                type={type}
                name={name}
                value={value}
                onChange={onChange}
                placeholder={placeholder}
                required={required}
                autoFocus={autoFocus}
                className="w-full px-4 py-2 border border-gray-300 rounded-lg 
                   focus:ring-2 focus:ring-blue-500 focus:border-transparent 
                   transition duration-200 outline-none"
            />
        </div>
    );
};

export default InputField;

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\components\Movie\MovieManagement.jsx ===

import React, { useState, useEffect } from 'react';
import axios from 'axios';

const MovieManagement = () => {
    const [movies, setMovies] = useState([]);
    const [filteredMovies, setFilteredMovies] = useState([]);
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState('');
    const [success, setSuccess] = useState('');

    // Form states
    const [showForm, setShowForm] = useState(false);
    const [editingMovie, setEditingMovie] = useState(null);
    const [searchTerm, setSearchTerm] = useState('');

    // New movie form data
    const [formData, setFormData] = useState({
        title: '',
        genre: '',
        duration: '',
        description: '',
        releaseDate: ''
    });

    // API base URL
    const API_BASE = 'http://localhost:8080/api/movies';

    // Axios interceptor for auth (giả sử dùng JWT)
    const getAuthHeaders = () => {
        const token = localStorage.getItem('authToken');
        return {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
        };
    };

    // Fetch all movies
    const fetchMovies = async () => {
        setLoading(true);
        try {
            const response = await axios.get(API_BASE, {
                headers: getAuthHeaders()
            });
            setMovies(response.data);
            setFilteredMovies(response.data);
            setError('');
        } catch (err) {
            setError('Lỗi khi tải danh sách phim: ' + (err.response?.data?.message || err.message));
        } finally {
            setLoading(false);
        }
    };

    // Search movies
    const handleSearch = async () => {
        if (!searchTerm.trim()) {
            setFilteredMovies(movies);
            return;
        }

        setLoading(true);
        try {
            const response = await axios.get(`${API_BASE}/search?title=${searchTerm}`, {
                headers: getAuthHeaders()
            });
            setFilteredMovies(response.data);
            setError('');
        } catch (err) {
            setError('Lỗi khi tìm kiếm phim: ' + (err.response?.data?.message || err.message));
        } finally {
            setLoading(false);
        }
    };

    // Create new movie
    const handleCreateMovie = async (e) => {
        e.preventDefault();
        setLoading(true);

        try {
            const movieData = {
                title: formData.title,
                genre: formData.genre,
                duration: parseInt(formData.duration),
                description: formData.description,
                releaseDate: formData.releaseDate
            };

            const response = await axios.post(API_BASE, movieData, {
                headers: getAuthHeaders()
            });

            setMovies([...movies, response.data]);
            setFilteredMovies([...movies, response.data]);
            setSuccess('Thêm phim thành công!');
            resetForm();
            setShowForm(false);
        } catch (err) {
            setError('Lỗi khi thêm phim: ' + (err.response?.data?.message || err.message));
        } finally {
            setLoading(false);
        }
    };

    // Update movie
    const handleUpdateMovie = async (e) => {
        e.preventDefault();
        setLoading(true);

        try {
            const movieData = {
                title: formData.title,
                genre: formData.genre,
                duration: parseInt(formData.duration),
                description: formData.description,
                releaseDate: formData.releaseDate
            };

            const response = await axios.put(`${API_BASE}/${editingMovie.movieID}`, movieData, {
                headers: getAuthHeaders()
            });

            const updatedMovies = movies.map(movie =>
                movie.movieID === editingMovie.movieID ? response.data : movie
            );

            setMovies(updatedMovies);
            setFilteredMovies(updatedMovies);
            setSuccess('Cập nhật phim thành công!');
            resetForm();
            setShowForm(false);
            setEditingMovie(null);
        } catch (err) {
            setError('Lỗi khi cập nhật phim: ' + (err.response?.data?.message || err.message));
        } finally {
            setLoading(false);
        }
    };

    // Delete movie
    const handleDeleteMovie = async (movieId) => {
        if (!window.confirm('Bạn có chắc chắn muốn xóa phim này?')) {
            return;
        }

        setLoading(true);
        try {
            await axios.delete(`${API_BASE}/${movieId}`, {
                headers: getAuthHeaders()
            });

            const updatedMovies = movies.filter(movie => movie.movieID !== movieId);
            setMovies(updatedMovies);
            setFilteredMovies(updatedMovies);
            setSuccess('Xóa phim thành công!');
        } catch (err) {
            setError('Lỗi khi xóa phim: ' + (err.response?.data?.message || err.message));
        } finally {
            setLoading(false);
        }
    };

    // Edit movie - populate form
    const handleEditMovie = (movie) => {
        setEditingMovie(movie);
        setFormData({
            title: movie.title,
            genre: movie.genre || '',
            duration: movie.duration.toString(),
            description: movie.description || '',
            releaseDate: movie.releaseDate || ''
        });
        setShowForm(true);
    };

    // Reset form
    const resetForm = () => {
        setFormData({
            title: '',
            genre: '',
            duration: '',
            description: '',
            releaseDate: ''
        });
        setEditingMovie(null);
    };

    // Handle form input changes
    const handleInputChange = (e) => {
        const { name, value } = e.target;
        setFormData(prev => ({
            ...prev,
            [name]: value
        }));
    };

    // Clear messages
    const clearMessages = () => {
        setError('');
        setSuccess('');
    };

    // Effects
    useEffect(() => {
        fetchMovies();
    }, []);

    useEffect(() => {
        if (!searchTerm) {
            setFilteredMovies(movies);
        }
    }, [searchTerm, movies]);

    return (
        <div className="container mx-auto p-6">
            <div className="bg-white rounded-lg shadow-lg p-6">
                {/* Header */}
                <div className="flex justify-between items-center mb-6">
                    <h1 className="text-2xl font-bold text-gray-800">Quản Lý Phim</h1>
                    <button
                        onClick={() => {
                            resetForm();
                            setShowForm(true);
                        }}
                        className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center"
                    >
                        <span className="mr-2">+</span> Thêm Phim Mới
                    </button>
                </div>

                {/* Search Bar */}
                <div className="mb-6 flex gap-4">
                    <input
                        type="text"
                        placeholder="Tìm kiếm phim theo tên..."
                        value={searchTerm}
                        onChange={(e) => setSearchTerm(e.target.value)}
                        onKeyPress={(e) => e.key === 'Enter' && handleSearch()}
                        className="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                    <button
                        onClick={handleSearch}
                        className="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg"
                    >
                        Tìm Kiếm
                    </button>
                    <button
                        onClick={() => {
                            setSearchTerm('');
                            fetchMovies();
                        }}
                        className="bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-lg"
                    >
                        Làm Mới
                    </button>
                </div>

                {/* Messages */}
                {error && (
                    <div className="mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded">
                        {error}
                        <button onClick={clearMessages} className="float-right font-bold">×</button>
                    </div>
                )}
                {success && (
                    <div className="mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded">
                        {success}
                        <button onClick={clearMessages} className="float-right font-bold">×</button>
                    </div>
                )}

                {/* Loading */}
                {loading && (
                    <div className="text-center py-4">
                        <div className="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                        <span className="ml-2">Đang tải...</span>
                    </div>
                )}

                {/* Movie Form Modal */}
                {showForm && (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                        <div className="bg-white rounded-lg p-6 w-full max-w-md">
                            <h2 className="text-xl font-bold mb-4">
                                {editingMovie ? 'Chỉnh Sửa Phim' : 'Thêm Phim Mới'}
                            </h2>
                            <form onSubmit={editingMovie ? handleUpdateMovie : handleCreateMovie}>
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">
                                            Tên phim *
                                        </label>
                                        <input
                                            type="text"
                                            name="title"
                                            value={formData.title}
                                            onChange={handleInputChange}
                                            required
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">
                                            Thể loại
                                        </label>
                                        <input
                                            type="text"
                                            name="genre"
                                            value={formData.genre}
                                            onChange={handleInputChange}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">
                                            Thời lượng (phút) *
                                        </label>
                                        <input
                                            type="number"
                                            name="duration"
                                            value={formData.duration}
                                            onChange={handleInputChange}
                                            required
                                            min="1"
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">
                                            Mô tả
                                        </label>
                                        <textarea
                                            name="description"
                                            value={formData.description}
                                            onChange={handleInputChange}
                                            rows="3"
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">
                                            Ngày phát hành
                                        </label>
                                        <input
                                            type="date"
                                            name="releaseDate"
                                            value={formData.releaseDate}
                                            onChange={handleInputChange}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        />
                                    </div>
                                </div>
                                <div className="flex justify-end space-x-3 mt-6">
                                    <button
                                        type="button"
                                        onClick={() => {
                                            setShowForm(false);
                                            resetForm();
                                        }}
                                        className="px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50"
                                    >
                                        Hủy
                                    </button>
                                    <button
                                        type="submit"
                                        disabled={loading}
                                        className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"
                                    >
                                        {loading ? 'Đang xử lý...' : (editingMovie ? 'Cập nhật' : 'Thêm mới')}
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                )}

                {/* Movies Table */}
                <div className="overflow-x-auto">
                    <table className="min-w-full bg-white border border-gray-200">
                        <thead>
                            <tr className="bg-gray-50">
                                <th className="px-6 py-3 border-b border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Tên Phim
                                </th>
                                <th className="px-6 py-3 border-b border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Thể Loại
                                </th>
                                <th className="px-6 py-3 border-b border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Thời Lượng
                                </th>
                                <th className="px-6 py-3 border-b border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Ngày Phát Hành
                                </th>
                                <th className="px-6 py-3 border-b border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Thao Tác
                                </th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-gray-200">
                            {filteredMovies.length === 0 ? (
                                <tr>
                                    <td colSpan="5" className="px-6 py-4 text-center text-gray-500">
                                        {loading ? 'Đang tải...' : 'Không có phim nào'}
                                    </td>
                                </tr>
                            ) : (
                                filteredMovies.map((movie) => (
                                    <tr key={movie.movieID} className="hover:bg-gray-50">
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <div className="text-sm font-medium text-gray-900">{movie.title}</div>
                                            {movie.description && (
                                                <div className="text-sm text-gray-500 truncate max-w-xs">
                                                    {movie.description}
                                                </div>
                                            )}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <div className="text-sm text-gray-900">{movie.genre || 'Chưa cập nhật'}</div>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <div className="text-sm text-gray-900">{movie.duration} phút</div>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <div className="text-sm text-gray-900">
                                                {movie.releaseDate ? new Date(movie.releaseDate).toLocaleDateString('vi-VN') : 'Chưa có'}
                                            </div>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button
                                                onClick={() => handleEditMovie(movie)}
                                                className="text-indigo-600 hover:text-indigo-900 mr-4"
                                            >
                                                Sửa
                                            </button>
                                            <button
                                                onClick={() => handleDeleteMovie(movie.movieID)}
                                                className="text-red-600 hover:text-red-900"
                                            >
                                                Xóa
                                            </button>
                                        </td>
                                    </tr>
                                ))
                            )}
                        </tbody>
                    </table>
                </div>

                {/* Pagination Info */}
                <div className="mt-4 text-sm text-gray-600">
                    Hiển thị {filteredMovies.length} trong tổng số {movies.length} phim
                </div>
            </div>
        </div>
    );
};

export default MovieManagement;

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\components\Promotion\PromotionBanner.jsx ===

// components/PromotionCarousel.jsx
import React from "react";
import { Swiper, SwiperSlide } from "swiper/react";
import { Navigation, Autoplay } from "swiper/modules";
import "swiper/css";
import "swiper/css/navigation";

const promotions = [
    {
        id: 1,
        title: "MUA VÉ ONLINE - Rinh quà Chaching",
        period: "Từ 01.10 đến 31.12.2025",
        condition: "Hóa đơn trên 250k tại Web / App Cinestar",
        prize: "tham gia VÒNG XOAY MAY MẮN",
        winRate: "100% trúng 1 trong 4 phần quà",
        gifts: ["Áo Chaching", "Nón Chaching", "Voucher 50k", "C Green"],
        girlImage: "https://via.placeholder.com/300x400/f9e4e4/ffffff?text=Chaching+Girl",
        bgGradient: "from-orange-400 to-red-500",
    },
    {
        id: 2,
        title: "ƯU ĐÃI THÀNH VIÊN",
        period: "Tháng 11/2025",
        condition: "Mua 2 vé tặng 1 bắp nước",
        prize: "Combo đặc biệt chỉ 99k",
        winRate: "Áp dụng cho thành viên VIP",
        gifts: ["Bắp rang", "Nước ngọt", "Voucher 20k"],
        girlImage: "https://via.placeholder.com/300x400/c8f7c5/000000?text=VIP+Girl",
        bgGradient: "from-green-400 to-teal-600",
    },
    {
        id: 3,
        title: "HAPPY DAY - GIẢM 50%",
        period: "Thứ 4 hàng tuần",
        condition: "Đặt vé online trước 12h",
        prize: "Giảm ngay 50k/vé",
        winRate: "Không giới hạn số lượng",
        gifts: ["Giảm giá", "Tặng ghế đôi", "Nước miễn phí"],
        girlImage: "https://via.placeholder.com/300x400/fff3cd/000000?text=Happy+Day",
        bgGradient: "from-yellow-400 to-amber-600",
    },
];

const PromotionCarousel = () => {
    return (
        <section className="py-8 bg-gradient-to-r from-orange-50 to-pink-50">
            <div className="container mx-auto px-4">
                <Swiper
                    modules={[Navigation, Autoplay]}
                    spaceBetween={30}
                    slidesPerView={1}
                    loop={true}
                    autoplay={{
                        delay: 4000,
                        disableOnInteraction: false,
                    }}
                    navigation={{
                        prevEl: ".promo-prev",
                        nextEl: ".promo-next",
                    }}
                    className="promotion-swiper rounded-2xl overflow-hidden shadow-2xl"
                >
                    {promotions.map((promo) => (
                        <SwiperSlide key={promo.id}>
                            <div className="bg-white rounded-2xl overflow-hidden">
                                {/* Nội dung chính */}
                                <div className={`relative grid grid-cols-1 md:grid-cols-3 gap-6 p-6 md:p-8 items-center bg-gradient-to-r ${promo.bgGradient}`}>
                                    {/* Cột 1: Logo + Tiêu đề */}
                                    <div className="text-center md:text-left space-y-3">
                                        <img
                                            src="/cinestar-logo-white.png"
                                            alt="Cinestar"
                                            className="h-10 mx-auto md:mx-0"
                                        />
                                        <h2 className="text-2xl md:text-3xl font-bold text-yellow-300 drop-shadow-lg">
                                            {promo.title.split(" - ")[0]}
                                        </h2>
                                        {promo.title.includes(" - ") && (
                                            <h3 className="text-xl md:text-2xl font-bold text-white">
                                                {promo.title.split(" - ")[1]}
                                            </h3>
                                        )}
                                    </div>

                                    {/* Cột 2: Nội dung */}
                                    <div className="text-white space-y-3 text-center md:text-left">
                                        <div className="bg-white/30 backdrop-blur-sm inline-block px-4 py-1.5 rounded-full text-sm font-bold">
                                            {promo.period}
                                        </div>
                                        <p className="text-sm md:text-base font-medium">
                                            {promo.condition}
                                            <br />
                                            <span className="text-yellow-300 font-bold text-lg">
                                                {promo.prize}
                                            </span>
                                        </p>
                                        <p className="text-green-300 font-bold text-sm">
                                            {promo.winRate}
                                        </p>

                                        <div className="flex justify-center md:justify-start gap-2 flex-wrap mt-3">
                                            {promo.gifts.map((gift, i) => (
                                                <div
                                                    key={i}
                                                    className="bg-white/30 backdrop-blur-sm rounded-lg px-3 py-1.5 text-xs font-medium"
                                                >
                                                    {gift}
                                                </div>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Cột 3: Hình + Nút */}
                                    <div className="flex flex-col items-center space-y-4">
                                        <img
                                            src={promo.girlImage}
                                            alt="Model"
                                            className="w-48 md:w-64 rounded-xl shadow-2xl"
                                        />
                                        <button className="px-8 py-3 bg-yellow-400 text-black font-bold text-lg rounded-full hover:bg-yellow-300 transform hover:scale-105 transition-all duration-200 shadow-xl">
                                            ĐẶT VÉ NGAY
                                        </button>
                                    </div>
                                </div>

                                {/* Ghi chú nhỏ */}
                                <div className="bg-gray-50 px-6 py-3 text-xs text-gray-600 border-t">
                                    <ul className="list-disc list-inside space-y-1">
                                        <li>Chương trình có thể thay đổi mà không báo trước.</li>
                                        <li>Áp dụng tại các rạp Cinestar trên toàn quốc.</li>
                                    </ul>
                                </div>
                            </div>
                        </SwiperSlide>
                    ))}
                </Swiper>

                {/* Nút điều hướng */}
                <div className="promo-prev !text-white !w-12 !h-12 after:!text-3xl"></div>
                <div className="promo-next !text-white !w-12 !h-12 after:!text-3xl"></div>
            </div>
        </section>
    );
};

export default PromotionCarousel;

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\components\Room\RoomManagement.jsx ===

import React, { useState, useEffect } from 'react';
import { Plus, Edit2, Trash2, Save, X, Copy, Grid, Sofa, Monitor, Settings } from 'lucide-react';
import axios from 'axios';

// Tạo instance axios với cấu hình mặc định
const api = axios.create({
    baseURL: 'http://localhost:8080/api',
    headers: {
        'Content-Type': 'application/json',
    },
});

// Thêm interceptor để xử lý token (nếu có)
api.interceptors.request.use(
    (config) => {
        const token = localStorage.getItem('authToken');
        if (token) {
            config.headers.Authorization = `Bearer ${token}`;
        }
        return config;
    },
    (error) => {
        return Promise.reject(error);
    }
);

// Thêm interceptor để xử lý response
api.interceptors.response.use(
    (response) => response,
    (error) => {
        console.error('API Error:', error);
        return Promise.reject(error);
    }
);

const SmartRoomManagement = () => {
    const [rooms, setRooms] = useState([]);
    const [selectedRoom, setSelectedRoom] = useState(null);
    const [seats, setSeats] = useState([]);
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState('');
    const [success, setSuccess] = useState('');

    // Modals
    const [showRoomModal, setShowRoomModal] = useState(false);
    const [showLayoutDesigner, setShowLayoutDesigner] = useState(false);
    const [showTemplateModal, setShowTemplateModal] = useState(false);
    const [showPriceConfig, setShowPriceConfig] = useState(false);

    // Room form
    const [roomForm, setRoomForm] = useState({
        roomID: null,
        roomName: '',
        totalSeats: 0,
        layout: '',
        roomType: 'STANDARD'
    });

    // Layout Designer
    const [layoutConfig, setLayoutConfig] = useState({
        rows: 10,
        columns: 12,
        rowLabels: 'ABCDEFGHIJ',
        startColumn: 1
    });

    const [seatGrid, setSeatGrid] = useState([]);
    const [seatMode, setSeatMode] = useState('single'); // single, couple, premium, aisle
    const [premiumZone, setPremiumZone] = useState({ start: null, end: null });

    // Price Configuration - Riêng cho từng phòng
    const [roomPriceConfig, setRoomPriceConfig] = useState({});

    // Seat Types với màu sắc (giá sẽ lấy từ roomPriceConfig)
    const SEAT_TYPES = {
        STANDARD: {
            name: 'Ghế Thường',
            color: 'bg-gray-100 border-gray-300 text-gray-700',
            colorActive: 'bg-green-500 text-white',
            icon: '💺'
        },
        COUPLE: {
            name: 'Ghế Đôi',
            color: 'bg-pink-100 border-pink-300 text-pink-700',
            colorActive: 'bg-pink-500 text-white',
            icon: '❤️',
            width: 2 // Ghế đôi chiếm 2 cột
        },
        PREMIUM: {
            name: 'Khu Trung Tâm',
            color: 'bg-yellow-100 border-yellow-400 text-yellow-800',
            colorActive: 'bg-yellow-500 text-white',
            icon: '⭐'
        },
        VIP: {
            name: 'Ghế VIP',
            color: 'bg-purple-100 border-purple-300 text-purple-700',
            colorActive: 'bg-purple-500 text-white',
            icon: '👑'
        }
    };

    // Giá mặc định
    const DEFAULT_PRICES = {
        STANDARD: 1.0,
        VIP: 1.5,
        COUPLE: 2.0,
        PREMIUM: 1.3
    };

    // Templates
    const TEMPLATES = {
        standard: {
            name: 'Standard Cinema',
            rows: 14,
            columns: 16,
            aisles: [{ type: 'vertical', positions: [5, 11] }],
            premiumZone: { rows: [5, 6, 7, 8], columns: [6, 7, 8, 9, 10] }
        },
        luxury: {
            name: 'Luxury Cinema',
            rows: 10,
            columns: 12,
            aisles: [{ type: 'vertical', positions: [6] }],
            coupleRows: ['H', 'I', 'J'],
            premiumZone: { rows: [4, 5, 6], columns: [4, 5, 6, 7, 8] }
        },
        imax: {
            name: 'IMAX',
            rows: 15,
            columns: 20,
            aisles: [
                { type: 'vertical', positions: [6, 14] },
                { type: 'horizontal', positions: [7] }
            ],
            premiumZone: { rows: [6, 7, 8, 9, 10], columns: [7, 8, 9, 10, 11, 12, 13] }
        }
    };

    // Fetch rooms
    useEffect(() => {
        fetchRooms();
        // Load price config từ localStorage nếu có
        const savedPriceConfig = localStorage.getItem('roomPriceConfig');
        if (savedPriceConfig) {
            setRoomPriceConfig(JSON.parse(savedPriceConfig));
        }
    }, []);

    // Lưu price config vào localStorage khi thay đổi
    useEffect(() => {
        localStorage.setItem('roomPriceConfig', JSON.stringify(roomPriceConfig));
    }, [roomPriceConfig]);

    // Hàm lấy giá cho từng phòng
    const getRoomPriceConfig = (roomId) => {
        return roomPriceConfig[roomId] || DEFAULT_PRICES;
    };

    // Hàm cập nhật giá cho phòng
    const updateRoomPriceConfig = (roomId, seatType, value) => {
        setRoomPriceConfig(prev => ({
            ...prev,
            [roomId]: {
                ...getRoomPriceConfig(roomId),
                [seatType]: parseFloat(value) || 0
            }
        }));
    };

    // Reset giá về mặc định cho phòng
    const resetRoomPriceConfig = (roomId) => {
        setRoomPriceConfig(prev => ({
            ...prev,
            [roomId]: DEFAULT_PRICES
        }));
    };

    const fetchRooms = async () => {
        setLoading(true);
        try {
            const response = await api.get('/rooms');
            setRooms(response.data);
        } catch (err) {
            setError('Lỗi khi tải danh sách phòng: ' + (err.response?.data?.message || err.message));
        } finally {
            setLoading(false);
        }
    };

    const fetchSeats = async (roomId) => {
        setLoading(true);
        try {
            const response = await api.get(`/rooms/${roomId}/seats`);
            setSeats(response.data);
            setSelectedRoom(roomId);

            const grid = convertSeatsToGrid(response.data);
            setSeatGrid(grid);
        } catch (err) {
            setError('Lỗi khi tải danh sách ghế: ' + (err.response?.data?.message || err.message));
        } finally {
            setLoading(false);
        }
    };

    const convertSeatsToGrid = (seatsData) => {
        const grid = {};
        seatsData.forEach(seat => {
            const match = seat.seatNumber.match(/^([A-Z]+)(\d+)$/);
            if (match) {
                const row = match[1];
                const col = parseInt(match[2]);
                if (!grid[row]) grid[row] = {};
                grid[row][col] = seat;
            }
        });
        return grid;
    };

    // Initialize seat grid
    const initializeSeatGrid = (template = null) => {
        const config = template || layoutConfig;
        const grid = [];
        const rowLabels = config.rowLabels || 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

        // Lấy cấu hình giá của phòng hiện tại
        const currentPriceConfig = selectedRoom ? getRoomPriceConfig(selectedRoom) : DEFAULT_PRICES;

        for (let i = 0; i < config.rows; i++) {
            const row = [];
            const rowLabel = rowLabels[i] || `R${i + 1}`;

            for (let j = 1; j <= config.columns; j++) {
                let isAisle = false;
                let isPremium = false;
                let seatType = 'STANDARD';

                if (template) {
                    // Check aisles
                    if (template.aisles) {
                        isAisle = template.aisles.some(aisle => {
                            if (aisle.type === 'vertical' && aisle.positions.includes(j)) return true;
                            if (aisle.type === 'horizontal' && aisle.positions.includes(i)) return true;
                            return false;
                        });
                    }

                    // Check premium zone
                    if (template.premiumZone && !isAisle) {
                        isPremium = template.premiumZone.rows.includes(i) &&
                            template.premiumZone.columns.includes(j);
                        if (isPremium) seatType = 'PREMIUM';
                    }

                    // Check couple rows
                    if (template.coupleRows && template.coupleRows.includes(rowLabel) && !isAisle) {
                        seatType = 'COUPLE';
                    }
                }

                row.push({
                    row: rowLabel,
                    column: j,
                    seatNumber: `${rowLabel}${j}`,
                    exists: !isAisle,
                    status: 'AVAILABLE',
                    seatType: seatType,
                    priceMultiplier: currentPriceConfig[seatType] || 1.0,
                    isCouple: seatType === 'COUPLE',
                    isPremium: isPremium
                });
            }
            grid.push(row);
        }

        setSeatGrid(grid);
    };

    // Toggle seat or change type
    const handleSeatClick = (rowIndex, colIndex) => {
        const newGrid = JSON.parse(JSON.stringify(seatGrid));
        const seat = newGrid[rowIndex][colIndex];

        // Lấy cấu hình giá của phòng hiện tại
        const currentPriceConfig = getRoomPriceConfig(selectedRoom);

        if (seatMode === 'aisle') {
            // Toggle existence (create aisle)
            seat.exists = !seat.exists;
            if (!seat.exists) {
                seat.seatType = 'STANDARD';
                seat.isCouple = false;
            }
        } else if (seatMode === 'couple') {
            // Create couple seat (merges with next seat)
            if (seat.exists && colIndex < seatGrid[rowIndex].length - 1) {
                seat.seatType = 'COUPLE';
                seat.isCouple = true;
                seat.priceMultiplier = currentPriceConfig.COUPLE || 2.0;
                // Mark next seat as part of couple
                const nextSeat = newGrid[rowIndex][colIndex + 1];
                if (nextSeat && nextSeat.exists) {
                    nextSeat.exists = false; // Hide next seat visually
                    nextSeat.partOfCouple = true;
                }
            }
        } else if (seatMode === 'premium') {
            if (seat.exists) {
                seat.seatType = 'PREMIUM';
                seat.isPremium = true;
                seat.priceMultiplier = currentPriceConfig.PREMIUM || 1.3;
            }
        } else if (seatMode === 'single') {
            if (seat.exists) {
                // Cycle through types
                const types = ['STANDARD', 'VIP'];
                const currentIndex = types.indexOf(seat.seatType);
                const nextType = types[(currentIndex + 1) % types.length];
                seat.seatType = nextType;
                seat.priceMultiplier = currentPriceConfig[nextType] || 1.0;
            } else {
                seat.exists = true;
                seat.seatType = 'STANDARD';
                seat.priceMultiplier = currentPriceConfig.STANDARD || 1.0;
            }
        }

        setSeatGrid(newGrid);
    };

    // Apply template
    const applyTemplate = (templateKey) => {
        const template = TEMPLATES[templateKey];
        setLayoutConfig({
            rows: template.rows,
            columns: template.columns,
            rowLabels: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.substring(0, template.rows)
        });
        initializeSeatGrid(template);
        setShowTemplateModal(false);
    };

    // Save layout to database
    const saveLayoutToDatabase = async () => {
        if (!selectedRoom) {
            setError('Vui lòng chọn phòng trước!');
            return;
        }

        setLoading(true);
        try {
            const room = rooms.find(r => r.roomID === selectedRoom);
            const layoutData = {
                roomID: selectedRoom,
                roomName: room.roomName,
                totalRows: seatGrid.length,
                totalColumns: seatGrid[0]?.length || 0,
                rowLabels: seatGrid.map(row => row[0]?.row).join(''),
                roomType: room.roomType || 'STANDARD',
                seats: []
            };

            seatGrid.forEach(row => {
                row.forEach(seat => {
                    layoutData.seats.push({
                        seatNumber: seat.seatNumber,
                        rowLabel: seat.row,
                        columnNumber: seat.column,
                        seatType: seat.seatType || 'STANDARD',
                        status: seat.status || 'AVAILABLE',
                        priceMultiplier: seat.priceMultiplier || 1.0,
                        exists: seat.exists && !seat.partOfCouple
                    });
                });
            });

            const response = await api.post(`/rooms/${selectedRoom}/layout`, layoutData);

            if (response.status === 200) {
                setSuccess('Lưu cấu hình ghế thành công!');
                setShowLayoutDesigner(false);
                fetchSeats(selectedRoom);
                fetchRooms();
            }
        } catch (err) {
            setError('Lỗi khi lưu cấu hình: ' + (err.response?.data?.message || err.message));
        } finally {
            setLoading(false);
        }
    };

    // Room CRUD
    const saveRoom = async (e) => {
        e.preventDefault();
        setLoading(true);

        try {
            let response;
            if (roomForm.roomID) {
                response = await api.put(`/rooms/${roomForm.roomID}`, roomForm);
            } else {
                response = await api.post('/rooms', roomForm);
            }

            if (response.status === 200) {
                setSuccess(roomForm.roomID ? 'Cập nhật phòng thành công!' : 'Thêm phòng thành công!');
                setShowRoomModal(false);
                resetRoomForm();
                fetchRooms();
            }
        } catch (err) {
            setError('Lỗi khi lưu phòng: ' + (err.response?.data?.message || err.message));
        } finally {
            setLoading(false);
        }
    };

    const deleteRoom = async (roomId) => {
        if (!window.confirm('Xóa phòng này? Tất cả ghế sẽ bị xóa!')) return;

        setLoading(true);
        try {
            await api.delete(`/rooms/${roomId}`);
            setSuccess('Xóa phòng thành công!');
            fetchRooms();
            if (selectedRoom === roomId) {
                setSelectedRoom(null);
                setSeats([]);
            }
        } catch (err) {
            setError('Lỗi khi xóa phòng: ' + (err.response?.data?.message || err.message));
        } finally {
            setLoading(false);
        }
    };

    const editRoom = (room) => {
        setRoomForm(room);
        setShowRoomModal(true);
    };

    const resetRoomForm = () => {
        setRoomForm({
            roomID: null,
            roomName: '',
            totalSeats: 0,
            layout: '',
            roomType: 'STANDARD'
        });
    };

    const openLayoutDesigner = () => {
        if (!selectedRoom) {
            setError('Vui lòng chọn phòng trước!');
            return;
        }

        if (seats.length > 0) {
            const existingGrid = [];
            const seatsByRow = {};

            seats.forEach(seat => {
                const match = seat.seatNumber.match(/^([A-Z]+)(\d+)$/);
                if (match) {
                    const row = match[1];
                    if (!seatsByRow[row]) seatsByRow[row] = [];
                    seatsByRow[row].push({ ...seat, column: parseInt(match[2]) });
                }
            });

            const rowLabels = Object.keys(seatsByRow).sort();
            let maxCol = 0;
            Object.values(seatsByRow).forEach(row => {
                row.forEach(seat => {
                    if (seat.column > maxCol) maxCol = seat.column;
                });
            });

            // Lấy cấu hình giá của phòng hiện tại
            const currentPriceConfig = getRoomPriceConfig(selectedRoom);

            rowLabels.forEach(rowLabel => {
                const row = [];
                for (let col = 1; col <= maxCol; col++) {
                    const seat = seatsByRow[rowLabel].find(s => s.column === col);
                    row.push({
                        row: rowLabel,
                        column: col,
                        seatNumber: `${rowLabel}${col}`,
                        exists: !!seat,
                        status: seat?.status || 'AVAILABLE',
                        seatType: seat?.seatType || 'STANDARD',
                        priceMultiplier: seat?.priceMultiplier || (currentPriceConfig[seat?.seatType] || 1.0),
                        seatID: seat?.seatID,
                        isCouple: seat?.seatType === 'COUPLE',
                        isPremium: seat?.seatType === 'PREMIUM'
                    });
                }
                existingGrid.push(row);
            });

            setSeatGrid(existingGrid);
        } else {
            initializeSeatGrid();
        }

        setShowLayoutDesigner(true);
    };

    // Get seat styling
    const getSeatStyle = (seat) => {
        if (!seat.exists || seat.partOfCouple) return 'bg-transparent border-transparent';

        const typeStyle = SEAT_TYPES[seat.seatType] || SEAT_TYPES.STANDARD;

        if (seat.status === 'AVAILABLE') {
            return `${typeStyle.color} border-2 hover:scale-110 transition-transform cursor-pointer`;
        }
        return typeStyle.colorActive;
    };

    const getSeatDisplay = (seat) => {
        if (!seat.exists || seat.partOfCouple) return '';

        const icon = SEAT_TYPES[seat.seatType]?.icon || '';

        if (seat.isCouple) {
            return <span className="text-xs">{icon}</span>;
        }

        return <span className="text-xs">{seat.column}</span>;
    };

    const getSeatWidth = (seat) => {
        if (seat.isCouple && seat.exists) return 'w-20'; // Double width
        return 'w-10';
    };

    // Áp dụng giá mới cho toàn bộ layout hiện tại
    const applyNewPricesToLayout = () => {
        if (seatGrid.length > 0) {
            const newGrid = JSON.parse(JSON.stringify(seatGrid));
            const currentPriceConfig = getRoomPriceConfig(selectedRoom);

            newGrid.forEach(row => {
                row.forEach(seat => {
                    if (seat.exists) {
                        seat.priceMultiplier = currentPriceConfig[seat.seatType] || 1.0;
                    }
                });
            });

            setSeatGrid(newGrid);
        }
    };

    return (
        <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 p-6">
            <div className="max-w-7xl mx-auto">
                {/* Header */}
                <div className="bg-white/10 backdrop-blur-md rounded-lg shadow-2xl p-6 mb-6 border border-white/20">
                    <div className="flex justify-between items-center">
                        <h1 className="text-3xl font-bold text-white">🎬 Quản Lý Phòng & Ghế</h1>
                        <div className="flex gap-3">
                            <button
                                onClick={() => setShowPriceConfig(true)}
                                disabled={!selectedRoom}
                                className="flex items-center gap-2 bg-gradient-to-r from-orange-500 to-red-500 text-white px-4 py-3 rounded-lg hover:from-orange-600 hover:to-red-600 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                <Settings className="w-5 h-5" />
                                Cấu Hình Giá Phòng
                            </button>
                            <button
                                onClick={() => {
                                    resetRoomForm();
                                    setShowRoomModal(true);
                                }}
                                className="flex items-center gap-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-lg hover:from-purple-600 hover:to-pink-600 shadow-lg"
                            >
                                <Plus className="w-5 h-5" />
                                Thêm Phòng
                            </button>
                        </div>
                    </div>
                </div>

                {/* Messages */}
                {error && (
                    <div className="mb-4 p-4 bg-red-500/20 border border-red-500 text-white rounded-lg flex justify-between backdrop-blur-md">
                        {error}
                        <button onClick={() => setError('')} className="font-bold">×</button>
                    </div>
                )}
                {success && (
                    <div className="mb-4 p-4 bg-green-500/20 border border-green-500 text-white rounded-lg flex justify-between backdrop-blur-md">
                        {success}
                        <button onClick={() => setSuccess('')} className="font-bold">×</button>
                    </div>
                )}

                <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    {/* Rooms List */}
                    <div className="bg-white/10 backdrop-blur-md rounded-lg shadow-2xl p-6 border border-white/20">
                        <h2 className="text-xl font-bold mb-4 text-white">Danh Sách Phòng</h2>

                        {rooms.length === 0 ? (
                            <div className="text-center text-white/60 py-8">Chưa có phòng nào</div>
                        ) : (
                            <div className="space-y-3">
                                {rooms.map(room => (
                                    <div
                                        key={room.roomID}
                                        className={`p-4 rounded-lg cursor-pointer transition-all ${selectedRoom === room.roomID
                                            ? 'bg-gradient-to-r from-purple-500/30 to-pink-500/30 border-2 border-white/40'
                                            : 'bg-white/5 border border-white/10 hover:bg-white/10'
                                            }`}
                                        onClick={() => fetchSeats(room.roomID)}
                                    >
                                        <div className="flex justify-between items-start">
                                            <div className="text-white">
                                                <h3 className="font-semibold text-lg">{room.roomName}</h3>
                                                <p className="text-sm text-white/70 flex items-center gap-1">
                                                    <Sofa className="w-4 h-4" />
                                                    {room.totalSeats} ghế
                                                </p>
                                                {/* Hiển thị thông tin giá nếu có cấu hình đặc biệt */}
                                                {roomPriceConfig[room.roomID] && (
                                                    <p className="text-xs text-yellow-300 mt-1 flex items-center gap-1">
                                                        <span>⭐</span>
                                                        Đã cấu hình giá riêng
                                                    </p>
                                                )}
                                            </div>
                                            <div className="flex gap-2">
                                                <button
                                                    onClick={(e) => {
                                                        e.stopPropagation();
                                                        editRoom(room);
                                                    }}
                                                    className="p-2 text-blue-300 hover:bg-blue-500/20 rounded"
                                                >
                                                    <Edit2 className="w-4 h-4" />
                                                </button>
                                                <button
                                                    onClick={(e) => {
                                                        e.stopPropagation();
                                                        deleteRoom(room.roomID);
                                                    }}
                                                    className="p-2 text-red-300 hover:bg-red-500/20 rounded"
                                                >
                                                    <Trash2 className="w-4 h-4" />
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>

                    {/* Seat Layout Display */}
                    <div className="lg:col-span-2 bg-white/10 backdrop-blur-md rounded-lg shadow-2xl p-6 border border-white/20">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-xl font-bold text-white">
                                {selectedRoom ? `Sơ Đồ Ghế - ${rooms.find(r => r.roomID === selectedRoom)?.roomName}` : 'Sơ Đồ Ghế'}
                            </h2>

                            {selectedRoom && (
                                <button
                                    onClick={openLayoutDesigner}
                                    className="flex items-center gap-2 bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-4 py-2 rounded-lg hover:from-blue-600 hover:to-cyan-600 shadow-lg"
                                >
                                    <Grid className="w-5 h-5" />
                                    Thiết Kế Layout
                                </button>
                            )}
                        </div>

                        {!selectedRoom ? (
                            <div className="text-center text-white/60 py-16">
                                <Monitor className="w-16 h-16 mx-auto mb-4" />
                                <p>Chọn một phòng để xem sơ đồ ghế</p>
                            </div>
                        ) : seats.length === 0 ? (
                            <div className="text-center text-white/60 py-16">
                                <Sofa className="w-16 h-16 mx-auto mb-4" />
                                <p className="mb-4">Phòng này chưa có ghế</p>
                                <button
                                    onClick={openLayoutDesigner}
                                    className="text-blue-300 hover:underline"
                                >
                                    Nhấn vào đây để thiết kế layout
                                </button>
                            </div>
                        ) : (
                            <div className="bg-black/30 p-6 rounded-lg border border-white/10">
                                {/* Screen */}
                                <div className="text-center mb-8">
                                    <div className="bg-gradient-to-b from-gray-700 to-gray-900 text-white py-3 px-8 rounded-lg inline-block shadow-2xl border-2 border-white/20">
                                        <Monitor className="inline w-5 h-5 mr-2" />
                                        MÀN HÌNH
                                    </div>
                                </div>

                                {/* Seats */}
                                <div className="flex flex-col items-center space-y-2 overflow-x-auto">
                                    {Object.keys(seatGrid).sort().map(rowKey => (
                                        <div key={rowKey} className="flex items-center gap-3">
                                            <div className="w-8 text-center font-bold text-white text-lg">{rowKey}</div>
                                            <div className="flex gap-1">
                                                {Object.keys(seatGrid[rowKey]).sort((a, b) => parseInt(a) - parseInt(b)).map(colKey => {
                                                    const seat = seatGrid[rowKey][colKey];
                                                    const width = getSeatWidth(seat);
                                                    const currentPriceConfig = getRoomPriceConfig(selectedRoom);
                                                    const price = currentPriceConfig[seat.seatType] || 1.0;

                                                    return (
                                                        <div
                                                            key={`${rowKey}-${colKey}`}
                                                            className={`${width} h-10 rounded flex items-center justify-center text-xs font-semibold ${getSeatStyle(seat)}`}
                                                            title={seat.exists ? `${seat.seatNumber} - ${SEAT_TYPES[seat.seatType]?.name} (×${price})` : ''}
                                                        >
                                                            {getSeatDisplay(seat)}
                                                        </div>
                                                    );
                                                })}
                                            </div>
                                        </div>
                                    ))}
                                </div>

                                {/* Legend */}
                                <div className="mt-8 flex justify-center gap-4 flex-wrap">
                                    {Object.entries(SEAT_TYPES).map(([key, type]) => {
                                        const currentPriceConfig = getRoomPriceConfig(selectedRoom);
                                        const price = currentPriceConfig[key] || 1.0;

                                        return (
                                            <div key={key} className="flex items-center gap-2 bg-white/10 px-3 py-2 rounded-lg">
                                                <div className={`w-6 h-6 rounded ${type.color} flex items-center justify-center text-sm`}>
                                                    {type.icon}
                                                </div>
                                                <span className="text-sm text-white">{type.name}</span>
                                                <span className="text-xs text-yellow-300 font-semibold">×{price}</span>
                                            </div>
                                        );
                                    })}
                                </div>

                                {/* Stats */}
                                <div className="mt-6 grid grid-cols-4 gap-4">
                                    <div className="bg-green-500/20 p-3 rounded-lg text-center border border-green-500/30">
                                        <div className="text-2xl font-bold text-green-300">
                                            {seats.filter(s => s.status === 'AVAILABLE').length}
                                        </div>
                                        <div className="text-sm text-green-200">Trống</div>
                                    </div>
                                    <div className="bg-pink-500/20 p-3 rounded-lg text-center border border-pink-500/30">
                                        <div className="text-2xl font-bold text-pink-300">
                                            {seats.filter(s => s.seatType === 'COUPLE').length}
                                        </div>
                                        <div className="text-sm text-pink-200">Ghế Đôi</div>
                                    </div>
                                    <div className="bg-yellow-500/20 p-3 rounded-lg text-center border border-yellow-500/30">
                                        <div className="text-2xl font-bold text-yellow-300">
                                            {seats.filter(s => s.seatType === 'PREMIUM').length}
                                        </div>
                                        <div className="text-sm text-yellow-200">Premium</div>
                                    </div>
                                    <div className="bg-purple-500/20 p-3 rounded-lg text-center border border-purple-500/30">
                                        <div className="text-2xl font-bold text-purple-300">
                                            {seats.filter(s => s.seatType === 'VIP').length}
                                        </div>
                                        <div className="text-sm text-purple-200">VIP</div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>

                {/* Room Modal */}
                {showRoomModal && (
                    <div className="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-50">
                        <div className="bg-gray-900 rounded-lg p-6 w-full max-w-md border border-white/20">
                            <h2 className="text-2xl font-bold mb-4 text-white">
                                {roomForm.roomID ? 'Chỉnh Sửa Phòng' : 'Thêm Phòng Mới'}
                            </h2>
                            <form onSubmit={saveRoom}>
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-white mb-2">
                                            Tên Phòng *
                                        </label>
                                        <input
                                            type="text"
                                            value={roomForm.roomName}
                                            onChange={(e) => setRoomForm({ ...roomForm, roomName: e.target.value })}
                                            className="w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:ring-2 focus:ring-purple-500"
                                            required
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-white mb-2">
                                            Loại Phòng
                                        </label>
                                        <select
                                            value={roomForm.roomType}
                                            onChange={(e) => setRoomForm({ ...roomForm, roomType: e.target.value })}
                                            className="w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:ring-2 focus:ring-purple-500"
                                        >
                                            <option value="STANDARD">Standard</option>
                                            <option value="VIP">VIP</option>
                                            <option value="IMAX">IMAX</option>
                                            <option value="4DX">4DX</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-white mb-2">
                                            Ghi Chú
                                        </label>
                                        <textarea
                                            value={roomForm.layout}
                                            onChange={(e) => setRoomForm({ ...roomForm, layout: e.target.value })}
                                            className="w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:ring-2 focus:ring-purple-500"
                                            rows="3"
                                        />
                                    </div>
                                </div>
                                <div className="flex gap-3 mt-6">
                                    <button
                                        type="button"
                                        onClick={() => {
                                            setShowRoomModal(false);
                                            resetRoomForm();
                                        }}
                                        className="flex-1 px-4 py-2 bg-white/10 rounded-lg hover:bg-white/20 text-white"
                                    >
                                        Hủy
                                    </button>
                                    <button
                                        type="submit"
                                        className="flex-1 px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg hover:from-purple-600 hover:to-pink-600"
                                    >
                                        {roomForm.roomID ? 'Cập Nhật' : 'Thêm Mới'}
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                )}

                {/* Layout Designer Modal */}
                {showLayoutDesigner && (
                    <div className="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50 overflow-y-auto">
                        <div className="bg-gray-900 rounded-lg w-full max-w-7xl my-8 border border-white/20">
                            <div className="sticky top-0 bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 flex justify-between items-center rounded-t-lg">
                                <h2 className="text-2xl font-bold">🎨 Thiết Kế Layout Ghế</h2>
                                <button onClick={() => setShowLayoutDesigner(false)} className="p-2 hover:bg-white/20 rounded">
                                    <X className="w-6 h-6" />
                                </button>
                            </div>

                            <div className="p-6 max-h-[80vh] overflow-y-auto">
                                {/* Controls */}
                                <div className="mb-6 space-y-4">
                                    {/* Mode Selection */}
                                    <div className="bg-white/5 p-4 rounded-lg border border-white/10">
                                        <h3 className="text-white font-semibold mb-3">Chế Độ Thiết Kế:</h3>
                                        <div className="grid grid-cols-2 md:grid-cols-5 gap-3">
                                            <button
                                                onClick={() => setSeatMode('single')}
                                                className={`px-4 py-3 rounded-lg transition-all ${seatMode === 'single'
                                                    ? 'bg-green-500 text-white shadow-lg'
                                                    : 'bg-white/10 text-white hover:bg-white/20'
                                                    }`}
                                            >
                                                💺 Ghế Đơn
                                            </button>
                                            <button
                                                onClick={() => setSeatMode('couple')}
                                                className={`px-4 py-3 rounded-lg transition-all ${seatMode === 'couple'
                                                    ? 'bg-pink-500 text-white shadow-lg'
                                                    : 'bg-white/10 text-white hover:bg-white/20'
                                                    }`}
                                            >
                                                ❤️ Ghế Đôi
                                            </button>
                                            <button
                                                onClick={() => setSeatMode('premium')}
                                                className={`px-4 py-3 rounded-lg transition-all ${seatMode === 'premium'
                                                    ? 'bg-yellow-500 text-white shadow-lg'
                                                    : 'bg-white/10 text-white hover:bg-white/20'
                                                    }`}
                                            >
                                                ⭐ Khu Trung Tâm
                                            </button>
                                            <button
                                                onClick={() => setSeatMode('aisle')}
                                                className={`px-4 py-3 rounded-lg transition-all ${seatMode === 'aisle'
                                                    ? 'bg-gray-500 text-white shadow-lg'
                                                    : 'bg-white/10 text-white hover:bg-white/20'
                                                    }`}
                                            >
                                                🚪 Lối Đi
                                            </button>
                                            <button
                                                onClick={() => setShowTemplateModal(true)}
                                                className="px-4 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-lg hover:from-blue-600 hover:to-cyan-600"
                                            >
                                                <Copy className="inline w-4 h-4 mr-1" />
                                                Template
                                            </button>
                                        </div>
                                    </div>

                                    {/* Grid Config */}
                                    <div className="bg-white/5 p-4 rounded-lg border border-white/10">
                                        <h3 className="text-white font-semibold mb-3">Cấu Hình Lưới:</h3>
                                        <div className="grid grid-cols-3 gap-4">
                                            <div>
                                                <label className="block text-sm font-medium mb-2 text-white">Số Hàng</label>
                                                <input
                                                    type="number"
                                                    value={layoutConfig.rows}
                                                    onChange={(e) => setLayoutConfig({ ...layoutConfig, rows: parseInt(e.target.value) })}
                                                    className="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white"
                                                    min="1"
                                                    max="26"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium mb-2 text-white">Số Cột</label>
                                                <input
                                                    type="number"
                                                    value={layoutConfig.columns}
                                                    onChange={(e) => setLayoutConfig({ ...layoutConfig, columns: parseInt(e.target.value) })}
                                                    className="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white"
                                                    min="1"
                                                    max="30"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium mb-2 text-white">Nhãn Hàng</label>
                                                <input
                                                    type="text"
                                                    value={layoutConfig.rowLabels}
                                                    onChange={(e) => setLayoutConfig({ ...layoutConfig, rowLabels: e.target.value })}
                                                    className="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white"
                                                    placeholder="ABCDEFGH..."
                                                />
                                            </div>
                                        </div>
                                        <button
                                            onClick={() => initializeSeatGrid()}
                                            className="mt-4 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"
                                        >
                                            Tạo Lưới Ghế
                                        </button>
                                    </div>

                                    {/* Price Info */}
                                    <div className="bg-green-500/10 p-4 rounded-lg border border-green-500/30">
                                        <h3 className="text-green-300 font-semibold mb-2">💰 Thông Tin Giá:</h3>
                                        <div className="grid grid-cols-2 md:grid-cols-4 gap-2">
                                            {Object.entries(SEAT_TYPES).map(([key, type]) => {
                                                const currentPriceConfig = getRoomPriceConfig(selectedRoom);
                                                const price = currentPriceConfig[key] || 1.0;
                                                return (
                                                    <div key={key} className="flex items-center gap-2 text-sm">
                                                        <div className={`w-4 h-4 rounded ${type.color} flex items-center justify-center text-xs`}>
                                                            {type.icon}
                                                        </div>
                                                        <span className="text-green-200">{type.name}</span>
                                                        <span className="text-yellow-300 font-semibold">×{price}</span>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                </div>

                                {/* Seat Grid */}
                                {seatGrid.length > 0 && (
                                    <div className="bg-black/30 p-6 rounded-lg border border-white/10">
                                        <div className="text-center mb-6">
                                            <div className="bg-gradient-to-b from-gray-700 to-gray-900 text-white py-3 px-8 rounded-lg inline-block shadow-xl border-2 border-white/20">
                                                <Monitor className="inline w-5 h-5 mr-2" />
                                                MÀN HÌNH
                                            </div>
                                        </div>

                                        <div className="flex flex-col items-center space-y-2 overflow-x-auto pb-4">
                                            {seatGrid.map((row, rowIndex) => (
                                                <div key={rowIndex} className="flex items-center gap-2">
                                                    <div className="w-8 text-center font-bold text-white text-lg">{row[0]?.row}</div>
                                                    <div className="flex gap-1">
                                                        {row.map((seat, colIndex) => {
                                                            const width = getSeatWidth(seat);
                                                            const currentPriceConfig = getRoomPriceConfig(selectedRoom);
                                                            const price = currentPriceConfig[seat.seatType] || 1.0;

                                                            return (
                                                                <button
                                                                    key={colIndex}
                                                                    onClick={() => handleSeatClick(rowIndex, colIndex)}
                                                                    className={`${width} h-10 rounded flex items-center justify-center text-xs font-semibold transition-all ${getSeatStyle(seat)} shadow-md`}
                                                                    title={
                                                                        seat.exists
                                                                            ? `${seat.seatNumber} - ${SEAT_TYPES[seat.seatType]?.name} (×${price}) - Click để ${seatMode === 'aisle' ? 'xóa' : 'thay đổi'}`
                                                                            : 'Click để thêm ghế'
                                                                    }
                                                                >
                                                                    {getSeatDisplay(seat)}
                                                                </button>
                                                            );
                                                        })}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>

                                        {/* Legend */}
                                        <div className="mt-8 flex justify-center gap-4 flex-wrap">
                                            {Object.entries(SEAT_TYPES).map(([key, type]) => {
                                                const currentPriceConfig = getRoomPriceConfig(selectedRoom);
                                                const price = currentPriceConfig[key] || 1.0;

                                                return (
                                                    <div key={key} className="flex items-center gap-2 bg-white/10 px-3 py-2 rounded-lg border border-white/20">
                                                        <div className={`w-6 h-6 rounded ${type.color} flex items-center justify-center text-sm border-2`}>
                                                            {type.icon}
                                                        </div>
                                                        <span className="text-sm text-white">{type.name}</span>
                                                        <span className="text-xs text-yellow-300 font-semibold">×{price}</span>
                                                    </div>
                                                );
                                            })}
                                        </div>

                                        {/* Stats */}
                                        <div className="mt-6 grid grid-cols-2 md:grid-cols-5 gap-4">
                                            <div className="bg-green-500/20 p-3 rounded-lg text-center border border-green-500/30">
                                                <div className="text-2xl font-bold text-green-300">
                                                    {seatGrid.flat().filter(s => s.exists && !s.partOfCouple).length}
                                                </div>
                                                <div className="text-sm text-green-200">Tổng ghế</div>
                                            </div>
                                            <div className="bg-gray-500/20 p-3 rounded-lg text-center border border-gray-500/30">
                                                <div className="text-2xl font-bold text-gray-300">
                                                    {seatGrid.flat().filter(s => s.seatType === 'STANDARD' && s.exists).length}
                                                </div>
                                                <div className="text-sm text-gray-200">Thường</div>
                                            </div>
                                            <div className="bg-pink-500/20 p-3 rounded-lg text-center border border-pink-500/30">
                                                <div className="text-2xl font-bold text-pink-300">
                                                    {seatGrid.flat().filter(s => s.seatType === 'COUPLE' && s.exists).length}
                                                </div>
                                                <div className="text-sm text-pink-200">Ghế Đôi</div>
                                            </div>
                                            <div className="bg-yellow-500/20 p-3 rounded-lg text-center border border-yellow-500/30">
                                                <div className="text-2xl font-bold text-yellow-300">
                                                    {seatGrid.flat().filter(s => s.seatType === 'PREMIUM' && s.exists).length}
                                                </div>
                                                <div className="text-sm text-yellow-200">Premium</div>
                                            </div>
                                            <div className="bg-purple-500/20 p-3 rounded-lg text-center border border-purple-500/30">
                                                <div className="text-2xl font-bold text-purple-300">
                                                    {seatGrid.flat().filter(s => s.seatType === 'VIP' && s.exists).length}
                                                </div>
                                                <div className="text-sm text-purple-200">VIP</div>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* Save Button */}
                                <div className="flex gap-3 mt-6">
                                    <button
                                        onClick={() => setShowLayoutDesigner(false)}
                                        className="flex-1 px-6 py-3 bg-white/10 rounded-lg hover:bg-white/20 text-white"
                                    >
                                        Hủy
                                    </button>
                                    <button
                                        onClick={saveLayoutToDatabase}
                                        disabled={loading}
                                        className="flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 disabled:opacity-50 flex items-center justify-center gap-2 shadow-lg"
                                    >
                                        <Save className="w-5 h-5" />
                                        {loading ? 'Đang lưu...' : 'Lưu Layout'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                )}

                {/* Price Configuration Modal */}
                {showPriceConfig && selectedRoom && (
                    <div className="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-50">
                        <div className="bg-gray-900 rounded-lg p-6 w-full max-w-md border border-white/20">
                            <div className="flex justify-between items-center mb-6">
                                <h2 className="text-2xl font-bold text-white">
                                    💰 Cấu Hình Giá - {rooms.find(r => r.roomID === selectedRoom)?.roomName}
                                </h2>
                                <button onClick={() => setShowPriceConfig(false)} className="p-2 hover:bg-white/10 rounded">
                                    <X className="w-6 h-6 text-white" />
                                </button>
                            </div>

                            <div className="space-y-4">
                                {Object.entries(SEAT_TYPES).map(([key, type]) => {
                                    const currentPrice = getRoomPriceConfig(selectedRoom)[key] || DEFAULT_PRICES[key];
                                    return (
                                        <div key={key} className="flex items-center justify-between p-4 bg-white/5 rounded-lg border border-white/10">
                                            <div className="flex items-center gap-3">
                                                <div className={`w-10 h-10 rounded-lg ${type.color} flex items-center justify-center text-lg border-2`}>
                                                    {type.icon}
                                                </div>
                                                <div>
                                                    <div className="text-white font-semibold">{type.name}</div>
                                                    <div className="text-sm text-white/60">Hệ số giá</div>
                                                </div>
                                            </div>
                                            <div className="flex items-center gap-2">
                                                <span className="text-white">×</span>
                                                <input
                                                    type="number"
                                                    step="0.1"
                                                    min="0.1"
                                                    max="10"
                                                    value={currentPrice}
                                                    onChange={(e) => updateRoomPriceConfig(selectedRoom, key, e.target.value)}
                                                    className="w-20 px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white text-center focus:ring-2 focus:ring-orange-500"
                                                />
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>

                            <div className="mt-6 bg-blue-500/10 p-4 rounded-lg border border-blue-500/30">
                                <p className="text-sm text-blue-200">
                                    <strong>💡 Giải thích:</strong> Hệ số giá sẽ nhân với giá vé cơ bản.
                                    Ví dụ: Ghế VIP ×1.5 = Giá vé × 1.5
                                </p>
                            </div>

                            <div className="flex gap-3 mt-6">
                                <button
                                    onClick={() => resetRoomPriceConfig(selectedRoom)}
                                    className="flex-1 px-4 py-2 bg-white/10 rounded-lg hover:bg-white/20 text-white"
                                >
                                    Đặt Lại Mặc Định
                                </button>
                                <button
                                    onClick={() => {
                                        setShowPriceConfig(false);
                                        applyNewPricesToLayout();
                                        setSuccess('Cập nhật giá thành công!');
                                    }}
                                    className="flex-1 px-4 py-2 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-lg hover:from-green-600 hover:to-blue-600"
                                >
                                    Lưu & Áp Dụng
                                </button>
                            </div>
                        </div>
                    </div>
                )}

                {/* Template Modal */}
                {showTemplateModal && (
                    <div className="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-50">
                        <div className="bg-gray-900 rounded-lg p-6 w-full max-w-4xl border border-white/20">
                            <div className="flex justify-between items-center mb-6">
                                <h2 className="text-2xl font-bold text-white">🎬 Chọn Template</h2>
                                <button onClick={() => setShowTemplateModal(false)} className="p-2 hover:bg-white/10 rounded">
                                    <X className="w-6 h-6 text-white" />
                                </button>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                {Object.entries(TEMPLATES).map(([key, template]) => (
                                    <button
                                        key={key}
                                        onClick={() => applyTemplate(key)}
                                        className="p-6 bg-white/5 border-2 border-white/10 rounded-lg hover:border-purple-500 hover:bg-purple-500/10 transition-all text-left group"
                                    >
                                        <h3 className="text-xl font-bold mb-3 text-white group-hover:text-purple-300">{template.name}</h3>
                                        <div className="text-sm text-white/70 space-y-2">
                                            <p className="flex items-center gap-2">
                                                <span className="text-purple-400">📐</span>
                                                {template.rows} hàng × {template.columns} cột
                                            </p>
                                            <p className="flex items-center gap-2">
                                                <span className="text-green-400">💺</span>
                                                ~{template.rows * template.columns - (template.aisles?.[0]?.positions?.length || 0)} ghế
                                            </p>
                                            {template.coupleRows && (
                                                <p className="flex items-center gap-2">
                                                    <span className="text-pink-400">❤️</span>
                                                    Có ghế đôi: {template.coupleRows.join(', ')}
                                                </p>
                                            )}
                                            {template.premiumZone && (
                                                <p className="flex items-center gap-2">
                                                    <span className="text-yellow-400">⭐</span>
                                                    Có khu trung tâm
                                                </p>
                                            )}
                                        </div>
                                        <div className="mt-4 flex justify-center bg-black/30 p-3 rounded">
                                            <div className="grid gap-0.5" style={{
                                                gridTemplateColumns: `repeat(${Math.min(template.columns, 16)}, 1fr)`
                                            }}>
                                                {Array.from({ length: Math.min(template.rows, 10) }).map((_, i) =>
                                                    Array.from({ length: Math.min(template.columns, 16) }).map((_, j) => {
                                                        let isAisle = false;
                                                        let isPremium = false;
                                                        let isCouple = false;

                                                        if (template.aisles) {
                                                            isAisle = template.aisles.some(aisle => {
                                                                if (aisle.type === 'vertical' && aisle.positions?.includes(j + 1)) return true;
                                                                if (aisle.type === 'horizontal' && aisle.positions?.includes(i)) return true;
                                                                return false;
                                                            });
                                                        }

                                                        if (template.premiumZone && !isAisle) {
                                                            isPremium = template.premiumZone.rows.includes(i) &&
                                                                template.premiumZone.columns.includes(j + 1);
                                                        }

                                                        const rowLabel = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'[i];
                                                        if (template.coupleRows?.includes(rowLabel) && !isAisle) {
                                                            isCouple = true;
                                                        }

                                                        return (
                                                            <div
                                                                key={`${i}-${j}`}
                                                                className={`w-2 h-2 rounded-sm ${isAisle ? 'bg-transparent' :
                                                                    isCouple ? 'bg-pink-500' :
                                                                        isPremium ? 'bg-yellow-500' : 'bg-green-500'
                                                                    }`}
                                                            />
                                                        );
                                                    })
                                                )}
                                            </div>
                                        </div>
                                    </button>
                                ))}
                            </div>

                            <div className="mt-6 bg-yellow-500/10 p-4 rounded-lg border border-yellow-500/30">
                                <p className="text-sm text-yellow-200">
                                    <strong>💡 Lưu ý:</strong> Chọn template sẽ tạo layout mới. Bạn có thể chỉnh sửa sau khi chọn.
                                </p>
                            </div>
                        </div>
                    </div>
                )}
            </div>
        </div>
    );
};

export default SmartRoomManagement;

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\contexts\ProductsContext.jsx ===

import React, { createContext, useContext, useState, useEffect } from 'react';
import { getProducts, getHomeData } from '../services/api';

const ProductsContext = createContext();

export const useProducts = () => {
  const context = useContext(ProductsContext);
  if (!context) {
    throw new Error('useProducts must be used within a ProductsProvider');
  }
  return context;
};

export const ProductsProvider = ({ children }) => {
  const [allProducts, setAllProducts] = useState([]);
  const [homeData, setHomeData] = useState(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  // Load all products for fuzzy search
  const loadAllProducts = async () => {
    try {
      setLoading(true);
      setError(null);
      
      // Load first 100 products for fuzzy search
      const response = await getProducts(1, 100);
      setAllProducts(response.data || []);
    } catch (err) {
      console.error('Error loading products for search:', err);
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  // Load home data
  const loadHomeData = async () => {
    try {
      const data = await getHomeData();
      setHomeData(data.data);
      
      // Also add home products to all products for search
      if (data.data) {
        const homeProducts = [
          ...(data.data.latest_products || []),
          ...(data.data.best_selling_products || []),
          ...(data.data.most_viewed_products || []),
          ...(data.data.highest_discount_products || [])
        ];
        
        // Remove duplicates
        const uniqueProducts = homeProducts.filter((product, index, self) =>
          index === self.findIndex(p => p.id === product.id)
        );
        
        setAllProducts(prev => {
          const combined = [...prev, ...uniqueProducts];
          return combined.filter((product, index, self) =>
            index === self.findIndex(p => p.id === product.id)
          );
        });
      }
    } catch (err) {
      console.error('Error loading home data:', err);
      setError(err.message);
    }
  };

  // Load products on mount
  useEffect(() => {
    loadAllProducts();
    loadHomeData();
  }, []);

  // Refresh products
  const refreshProducts = () => {
    loadAllProducts();
  };

  // Add new product to the list (for real-time updates)
  const addProduct = (product) => {
    setAllProducts(prev => {
      const exists = prev.find(p => p.id === product.id);
      if (exists) {
        return prev.map(p => p.id === product.id ? product : p);
      }
      return [...prev, product];
    });
  };

  // Update product in the list
  const updateProduct = (productId, updatedProduct) => {
    setAllProducts(prev =>
      prev.map(p => p.id === productId ? { ...p, ...updatedProduct } : p)
    );
  };

  // Remove product from the list
  const removeProduct = (productId) => {
    setAllProducts(prev => prev.filter(p => p.id !== productId));
  };

  const value = {
    allProducts,
    homeData,
    loading,
    error,
    refreshProducts,
    addProduct,
    updateProduct,
    removeProduct
  };

  return (
    <ProductsContext.Provider value={value}>
      {children}
    </ProductsContext.Provider>
  );
};

export default ProductsContext;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\features\authSlice.js ===

import { createSlice, createAsyncThunk } from "@reduxjs/toolkit";
import { apiRequest } from "../services/api";

// Login
export const loginUser = createAsyncThunk("auth/loginUser", async (credentials, { rejectWithValue }) => {
  try {
    const data = await apiRequest("/api/auth/login", "POST", credentials);
    localStorage.setItem("token", data.token);
    return data;
  } catch (error) {
    return rejectWithValue(error.message);
  }
});

// Register
export const registerUser = createAsyncThunk("auth/registerUser", async (formData, { rejectWithValue }) => {
  try {
    const data = await apiRequest("/api/auth/register", "POST", formData);
    return data;
  } catch (error) {
    return rejectWithValue(error.message);
  }
});

const authSlice = createSlice({
  name: "auth",
  initialState: {
    user: null,
    token: localStorage.getItem("token") || null,
    loading: false,
    error: null,
  },
  reducers: {
    logout: (state) => {
      state.user = null;
      state.token = null;
      localStorage.removeItem("token");
    },
  },
  extraReducers: (builder) => {
    builder
      .addCase(loginUser.pending, (state) => {
        state.loading = true;
        state.error = null;
      })
      .addCase(loginUser.fulfilled, (state, action) => {
        state.loading = false;
        state.user = action.payload.user;
        state.token = action.payload.token;
      })
      .addCase(loginUser.rejected, (state, action) => {
        state.loading = false;
        state.error = action.payload;
      })
      .addCase(registerUser.pending, (state) => {
        state.loading = true;
        state.error = null;
      })
      .addCase(registerUser.fulfilled, (state) => {
        state.loading = false;
      })
      .addCase(registerUser.rejected, (state, action) => {
        state.loading = false;
        state.error = action.payload;
      });
  },
});

export const { logout } = authSlice.actions;
export default authSlice.reducer;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\hooks\useDebounce.js ===

import { useState, useEffect } from 'react';

// Custom hook for debouncing values
export const useDebounce = (value, delay) => {
  const [debouncedValue, setDebouncedValue] = useState(value);

  useEffect(() => {
    const handler = setTimeout(() => {
      setDebouncedValue(value);
    }, delay);

    return () => {
      clearTimeout(handler);
    };
  }, [value, delay]);

  return debouncedValue;
};


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\hooks\useFuzzySearch.js ===

import { useState, useMemo, useEffect } from 'react';
import Fuse from 'fuse.js';

const useFuzzySearch = (data, searchQuery, options = {}) => {
  const [results, setResults] = useState([]);
  const [isSearching, setIsSearching] = useState(false);

  // Default Fuse.js options
  const defaultOptions = {
    keys: ['name', 'description', 'category_name'],
    threshold: 0.4, // 0 = exact match, 1 = match anything
    distance: 100,
    includeScore: true,
    includeMatches: true,
    minMatchCharLength: 1,
    shouldSort: true,
    ...options
  };

  // Create Fuse instance
  const fuse = useMemo(() => {
    if (!data || data.length === 0) return null;
    return new Fuse(data, defaultOptions);
  }, [data, JSON.stringify(defaultOptions)]);

  // Perform search
  useEffect(() => {
    if (!fuse || !searchQuery.trim()) {
      setResults([]);
      setIsSearching(false);
      return;
    }

    setIsSearching(true);
    
    try {
      const searchResults = fuse.search(searchQuery);
      
      // Transform results to include original item and search metadata
      const transformedResults = searchResults.map(result => ({
        ...result.item,
        _fuzzyScore: result.score,
        _fuzzyMatches: result.matches || []
      }));

      setResults(transformedResults);
    } catch (error) {
      console.error('Fuzzy search error:', error);
      setResults([]);
    } finally {
      setIsSearching(false);
    }
  }, [fuse, searchQuery]);

  // Get highlighted text function
  const getHighlightedText = (text, matches = []) => {
    if (!matches || matches.length === 0) return text;

    let highlightedText = text;
    const ranges = [];

    // Collect all match ranges
    matches.forEach(match => {
      if (match.indices) {
        match.indices.forEach(([start, end]) => {
          ranges.push({ start, end: end + 1 });
        });
      }
    });

    // Sort ranges by start position (descending to avoid index shifting)
    ranges.sort((a, b) => b.start - a.start);

    // Apply highlights
    ranges.forEach(({ start, end }) => {
      const before = highlightedText.slice(0, start);
      const highlighted = highlightedText.slice(start, end);
      const after = highlightedText.slice(end);
      
      highlightedText = `${before}<mark class="bg-yellow-200 px-1 rounded">${highlighted}</mark>${after}`;
    });

    return highlightedText;
  };

  return {
    results,
    isSearching,
    getHighlightedText,
    totalResults: results.length
  };
};

export default useFuzzySearch;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\pages\Auth\Checkout.jsx ===

import { useState } from "react";
import axios from "axios";
import { useNavigate } from "react-router-dom";

const Checkout = () => {
    const navigate = useNavigate();

    const [form, setForm] = useState({
        shipping_address: "",
        notes: "",
        payment_method: "COD",
    });

    const handleSubmit = async (e) => {
        e.preventDefault();
        try {
            const token = localStorage.getItem("token");


            const res = await axios.post(
                "http://localhost:3000/api/orders/from-cart",
                form,
                { headers: { Authorization: `Bearer ${token}` } }
            );

            const newOrder = res.data.order; // giả sử backend trả về đơn hàng vừa tạo
            alert("Đặt hàng thành công!");

            setForm({ shipping_address: "", notes: "", payment_method: "COD" });

            // Chuyển trang và truyền đơn hàng mới
            navigate("/order-history", { state: { newOrder } });

        } catch {
            alert("Đặt hàng thất bại.");
        }
    };


    return (
        <div className="max-w-3xl mx-auto p-6 bg-white shadow rounded-lg">
            <h2 className="text-xl font-bold text-green-700 mb-4">Thanh toán đơn hàng</h2>
            <form onSubmit={handleSubmit} className="space-y-4">
                <div>
                    <label className="block text-sm font-semibold">Địa chỉ giao hàng</label>
                    <input
                        type="text"
                        value={form.shipping_address}
                        onChange={(e) => setForm({ ...form, shipping_address: e.target.value })}
                        className="w-full border rounded-lg p-2"
                        required
                    />
                </div>
                <div>
                    <label className="block text-sm font-semibold">Ghi chú</label>
                    <textarea
                        value={form.notes}
                        onChange={(e) => setForm({ ...form, notes: e.target.value })}
                        className="w-full border rounded-lg p-2"
                        rows="2"
                    />
                </div>
                <div>
                    <label className="block text-sm font-semibold">Phương thức thanh toán</label>
                    <select
                        value={form.payment_method}
                        onChange={(e) => setForm({ ...form, payment_method: e.target.value })}
                        className="w-full border rounded-lg p-2"
                    >
                        <option value="COD">Thanh toán khi nhận hàng (COD)</option>
                        <option value="BANK">Chuyển khoản ngân hàng</option>
                        <option value="PAYPAL">PayPal</option>
                    </select>
                </div>
                <button
                    type="submit"
                    className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700"
                >
                    Xác nhận đặt hàng
                </button>
            </form>
        </div>
    );
};

export default Checkout;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\pages\Auth\ForgotPassword.jsx ===

import React, { useState } from "react";
import { useNavigate } from "react-router-dom";

const ForgotPassword = () => {
    const [email, setEmail] = useState("");
    const [message, setMessage] = useState("");
    const [loading, setLoading] = useState(false);
    const navigate = useNavigate();

    const handleSubmit = async (e) => {
        e.preventDefault();
        setLoading(true);
        setMessage("");

        try {
            const res = await fetch("http://localhost:3000/api/auth/forgot-password", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email }),
            });

            const data = await res.json();
            if (data.success) {
                setMessage("✅ OTP đã được gửi về email của bạn!");
                localStorage.setItem("email", email);
                setTimeout(() => {
                    navigate("/verify-otp");
                }, 1500);
            } else {
                setMessage(data.message || "❌ Gửi OTP thất bại!");
            }
        } catch (err) {
            setMessage("❌ Lỗi kết nối server!");
        } finally {
            setLoading(false);
        }
    };

    return (
        <div className="flex items-center justify-center min-h-screen bg-green-50">
            <form
                onSubmit={handleSubmit}
                className="bg-white p-8 rounded-2xl shadow-lg w-full max-w-md border"
            >
                <h2 className="text-2xl font-bold text-center mb-6 text-black-600">
                    Quên mật khẩu
                </h2>

                {message && (
                    <p
                        className={`mb-4 text-center font-medium ${message.includes("✅") ? "text-green-600" : "text-red-500"
                            }`}
                    >
                        {message}
                    </p>
                )}

                <input
                    type="email"
                    placeholder="Nhập email đăng ký"
                    value={email}
                    onChange={(e) => setEmail(e.target.value)}
                    className="w-full px-4 py-2 mb-6 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400"
                    required
                />

                <button
                    type="submit"
                    disabled={loading}
                    className="w-full bg-yellow-500 text-white py-2 rounded-lg hover:bg-blue-500 transition"
                >
                    {loading ? "Đang gửi OTP..." : "Gửi OTP"}
                </button>
            </form>
        </div>
    );
};

export default ForgotPassword;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\pages\Auth\Login.jsx ===

import { useState } from "react";
import { useDispatch, useSelector } from "react-redux";
import axios from "axios";
import InputField from "../../components/Login/InputField";
import { useNavigate } from "react-router-dom";

const Login = () => {
    const dispatch = useDispatch();
    const navigate = useNavigate();
    const { loading } = useSelector((state) => state.auth);

    const [form, setForm] = useState({ email: "", password: "" });
    const [error, setError] = useState(null);

    const handleChange = (e) =>
        setForm({ ...form, [e.target.name]: e.target.value });

    const handleSubmit = async (e) => {
        e.preventDefault();
        setError(null);

        try {
            const res = await axios.post(
                "http://localhost:8080/api/auth/login",
                form
            );
            const data = res.data;

            if (data.token) {
                localStorage.setItem("token", data.token);
                localStorage.setItem("userName", data.name);
                localStorage.setItem("userEmail", data.email);
                localStorage.setItem("userRole", data.role);

                dispatch(loginUser(data));

                switch (data.role) {
                    case "ADMIN":
                        navigate("/admin/dashboard");
                        break;
                    case "STAFF":
                        navigate("/staff");
                        break;
                    default:
                        navigate("/home");
                        break;
                }
            } else {
                setError("Đăng nhập thất bại. Vui lòng kiểm tra lại thông tin.");
            }
        } catch (err) {
            console.error("Login error:", err.response?.data || err.message);
            setError(err.response?.data?.message || "Lỗi server. Vui lòng thử lại.");
        }
    };

    return (
        <div className="flex justify-center items-center min-h-screen bg-gray-50">
            <form
                onSubmit={handleSubmit}
                className="bg-white p-8 rounded-xl shadow-lg w-full max-w-md border border-gray-200"
            >
                <h2 className="text-2xl font-bold text-center mb-6 text-gray-800">
                    Đăng nhập
                </h2>

                {error && (
                    <p className="text-red-600 bg-red-50 p-3 rounded-lg text-sm text-center mb-4 border border-red-200">
                        {error}
                    </p>
                )}

                <InputField
                    label="Email"
                    type="email"
                    name="email"
                    value={form.email}
                    onChange={handleChange}
                    required
                    placeholder="Nhập email của bạn"
                    autoFocus
                />

                <div className="mb-5"></div>

                <InputField
                    label="Mật khẩu"
                    type="password"
                    name="password"
                    value={form.password}
                    onChange={handleChange}
                    required
                    placeholder="Nhập mật khẩu"
                />

                <button
                    type="submit"
                    disabled={loading}
                    className={`w-full mt-6 py-3 rounded-lg font-bold text-white text-lg 
                transition-all duration-300 shadow-md
                ${loading
                            ? "bg-gray-400 cursor-not-allowed opacity-70"
                            : "bg-yellow-500 hover:bg-blue-600 active:bg-blue-700"
                        }`}
                >
                    {loading ? "Đang đăng nhập..." : "Đăng nhập"}
                </button>

                <div className="flex justify-between mt-5 text-sm">
                    <button
                        type="button"
                        onClick={() => navigate("/forgot-password")}
                        className="text-black-600 hover:underline font-medium"
                    >
                        Quên mật khẩu?
                    </button>
                    <button
                        type="button"
                        onClick={() => navigate("/register")}
                        className="text-black-600 hover:underline font-medium"
                    >
                        Chưa có tài khoản? Đăng ký
                    </button>
                </div>
            </form>
        </div>
    );
};

export default Login;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\pages\Auth\Profile.jsx ===

import React, { useState, useEffect } from "react";
import axios from "axios";
import { useNavigate } from "react-router-dom";

const Profile = () => {
    const token = localStorage.getItem("token");
    const [activeTab, setActiveTab] = useState("profile");

    const [profile, setProfile] = useState({ full_name: "", email: "", phone: "", avatar_url: "" });
    const [avatarFile, setAvatarFile] = useState(null);
    const [avatarUrl, setAvatarUrl] = useState("");

    const [passwords, setPasswords] = useState({ current: "", new: "", confirm: "" });
    const [stats, setStats] = useState(null);
    const [otps, setOtps] = useState([]);
    const [loading, setLoading] = useState(false);
    const [message, setMessage] = useState("");
    const [errors, setErrors] = useState([]);

    const navigate = useNavigate();

    useEffect(() => {
        const fetchProfile = async () => {
            try {
                const res = await axios.get("http://localhost:3000/api/user/profile", { headers: { Authorization: `Bearer ${token}` } });
                if (res.data.success) {
                    setProfile(res.data.data.user);
                    setAvatarUrl(res.data.data.user.avatar_url || "");
                }
            } catch { }
        };
        const fetchStats = async () => {
            try {
                const res = await axios.get("http://localhost:3000/api/user/stats", { headers: { Authorization: `Bearer ${token}` } });
                if (res.data.success) setStats(res.data.data);
            } catch { }
        };
        const fetchOtps = async () => {
            try {
                const res = await axios.get("http://localhost:3000/api/user/otps?limit=5", { headers: { Authorization: `Bearer ${token}` } });
                if (res.data.success) setOtps(res.data.data.otps);
            } catch { }
        };
        fetchProfile();
        fetchStats();
        fetchOtps();
    }, [token]);

    const handleProfileChange = (e) => setProfile({ ...profile, [e.target.name]: e.target.value });
    const handlePasswordChange = (e) => setPasswords({ ...passwords, [e.target.name]: e.target.value });

    const handleAvatarChange = (e) => {
        const file = e.target.files[0];
        if (!file) return;
        setAvatarFile(file);
        const reader = new FileReader();
        reader.onload = () => setAvatarUrl(reader.result);
        reader.readAsDataURL(file);
    };

    const updateProfile = async (e) => {
        e.preventDefault();
        setLoading(true);
        setMessage("");
        setErrors([]);

        try {
            let uploadedUrl = avatarUrl;


            if (avatarFile) {
                const formData = new FormData();
                formData.append("avatar", avatarFile);
                const uploadRes = await axios.post(
                    "http://localhost:3000/api/user/upload-avatar",
                    formData,
                    { headers: { Authorization: `Bearer ${token}`, "Content-Type": "multipart/form-data" } }
                );
                uploadedUrl = uploadRes.data.url;
            }

            const res = await axios.put(
                "http://localhost:3000/api/user/profile",
                {
                    full_name: profile.full_name,
                    phone: profile.phone,
                    avatar_url: "anhThe.jpg"
                },
                { headers: { Authorization: `Bearer ${token}` } }
            );

            if (res.data.success) {
                setMessage("✅ Cập nhật profile thành công!");
                setProfile(res.data.data.user);
                setAvatarUrl(res.data.data.user.avatar_url || "");
            } else {
                setMessage(res.data.message);
            }
        } catch (err) {
            const data = err.response?.data;
            if (data?.errors) setErrors(data.errors);
            setMessage(data?.message || "❌ Lỗi server!");
        } finally {
            setLoading(false);
        }
    };

    const changePassword = async (e) => {
        e.preventDefault();
        setLoading(true);
        setMessage("");
        setErrors([]);

        try {
            const res = await axios.post(
                "http://localhost:3000/api/user/change-password",
                { current_password: passwords.current, new_password: passwords.new, confirm_password: passwords.confirm },
                { headers: { Authorization: `Bearer ${token}` } }
            );

            if (res.data.success) {
                setMessage("✅ Đổi mật khẩu thành công!");
                setPasswords({ current: "", new: "", confirm: "" });
            } else setMessage(res.data.message);
        } catch (err) {
            const data = err.response?.data;
            if (data?.errors) setErrors(data.errors);
            setMessage(data?.message || "❌ Lỗi server!");
        } finally {
            setLoading(false);
        }
    };

    const deleteAccount = async () => {
        const confirm = window.prompt("Nhập mật khẩu để xác nhận xóa tài khoản:");
        if (!confirm) return;
        try {
            const res = await axios.delete(
                "http://localhost:3000/api/user/account",
                { headers: { Authorization: `Bearer ${token}` }, data: { password: confirm } }
            );
            if (res.data.success) {
                alert("Tài khoản đã xóa thành công!");
                localStorage.removeItem("token");
                navigate("/login");
            }
        } catch (err) {
            alert(err.response?.data?.message || "❌ Lỗi xóa tài khoản");
        }
    };

    const tabs = [
        { id: "profile", label: "Thông tin cá nhân" },
        { id: "password", label: "Đổi mật khẩu" },
        { id: "stats", label: "Thống kê & OTP" },
        { id: "delete", label: "Xóa tài khoản" }
    ];

    const logout = () => {
        localStorage.removeItem("token");
        navigate("/login");
    };

    return (
        <div className="min-h-screen bg-green-50 p-4 flex flex-col items-center">
            {/* Menu Tabs */}
            <div className="w-full max-w-lg mb-4 flex justify-around bg-white rounded-xl shadow">
                {tabs.map(tab => (
                    <button
                        key={tab.id}
                        className={`flex-1 py-2 font-medium ${activeTab === tab.id ? "bg-green-500 text-white rounded-xl" : "text-green-700"}`}
                        onClick={() => setActiveTab(tab.id)}
                    >
                        {tab.label}
                    </button>
                ))}
            </div>

            {/* Nội dung tab */}
            <div className="w-full max-w-lg">
                {/* --- PROFILE --- */}
                {activeTab === "profile" && (
                    <div className="bg-white rounded-2xl shadow-lg p-6">
                        {message && <p className={`mb-4 text-center font-medium ${message.includes("✅") ? "text-green-600" : "text-red-500"}`}>{message}</p>}
                        {errors.length > 0 && <ul className="mb-4 text-red-500 list-disc list-inside">{errors.map((e, i) => <li key={i}>{e.field}: {e.message}</li>)}</ul>}

                        <form onSubmit={updateProfile}>
                            <label className="block mb-1">Họ và tên</label>
                            <input type="text" name="full_name" value={profile.full_name} onChange={handleProfileChange} className="w-full mb-2 p-2 border rounded" />

                            <label className="block mb-1">Email</label>
                            <input type="email" name="email" value={profile.email} readOnly className="w-full mb-2 p-2 border bg-gray-100 cursor-not-allowed" />

                            <label className="block mb-1">Số điện thoại</label>
                            <input type="text" name="phone" value={profile.phone} onChange={handleProfileChange} className="w-full mb-4 p-2 border rounded" />

                            <label className="block mb-1">Ảnh đại diện</label>
                            <div className="mb-4 flex items-center gap-4">
                                {avatarUrl && <img src={avatarUrl} alt="Avatar" className="w-16 h-16 rounded-full object-cover" />}
                                <input type="file" accept="image/*" onChange={handleAvatarChange} />
                            </div>

                            <button type="submit" disabled={loading} className="w-full bg-green-500 text-white py-2 rounded hover:bg-green-600 mb-2">{loading ? "Đang lưu..." : "Cập nhật"}</button>
                        </form>
                    </div>
                )}

                {/* --- PASSWORD --- */}
                {activeTab === "password" && (
                    <div className="bg-white rounded-2xl shadow-lg p-6">
                        {message && <p className={`mb-4 text-center font-medium ${message.includes("✅") ? "text-green-600" : "text-red-500"}`}>{message}</p>}
                        {errors.length > 0 && <ul className="mb-4 text-red-500 list-disc list-inside">{errors.map((e, i) => <li key={i}>{e.field}: {e.message}</li>)}</ul>}

                        <form onSubmit={changePassword}>
                            <input type="password" name="current" value={passwords.current} onChange={handlePasswordChange} placeholder="Mật khẩu hiện tại" className="w-full mb-2 p-2 border rounded" />
                            <input type="password" name="new" value={passwords.new} onChange={handlePasswordChange} placeholder="Mật khẩu mới" className="w-full mb-2 p-2 border rounded" />
                            <input type="password" name="confirm" value={passwords.confirm} onChange={handlePasswordChange} placeholder="Xác nhận mật khẩu mới" className="w-full mb-4 p-2 border rounded" />
                            <button type="submit" disabled={loading} className="w-full bg-green-500 text-white py-2 rounded hover:bg-green-600 mb-2">{loading ? "Đang lưu..." : "Đổi mật khẩu"}</button>
                        </form>
                    </div>
                )}

                {/* --- STATS --- */}
                {activeTab === "stats" && (
                    <div className="bg-white rounded-2xl shadow-lg p-6">
                        {stats && (
                            <ul className="mb-4">
                                <li>Đã xác thực: {stats.is_verified ? "✅" : "❌"}</li>
                                <li>Tổng OTP đã dùng: {stats.used_otps}</li>
                                <li>OTP hết hạn: {stats.expired_otps}</li>
                            </ul>
                        )}
                        {otps.length > 0 && (
                            <>
                                <h3 className="font-medium mb-2">Lịch sử OTP gần đây</h3>
                                <ul className="text-sm mb-2">
                                    {otps.map((o) => (
                                        <li key={o.id}>{o.otp_type} - {o.is_used ? "Đã dùng" : "Chưa dùng"} - Hết hạn: {o.is_expired ? "✅" : "❌"}</li>
                                    ))}
                                </ul>
                            </>
                        )}
                    </div>
                )}

                {/* --- DELETE --- */}
                {activeTab === "delete" && (
                    <div className="bg-white rounded-2xl shadow-lg p-6">
                        <h2 className="text-xl font-bold mb-4 text-red-600">Xóa tài khoản</h2>
                        <button onClick={deleteAccount} className="w-full bg-red-500 text-white py-2 rounded hover:bg-red-600">Xóa tài khoản</button>
                    </div>
                )}
            </div>

            {/* Nút Đăng xuất */}
            <div className="w-full max-w-lg mt-6 flex justify-end">
                <button
                    onClick={logout}
                    className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"
                >
                    Đăng xuất
                </button>
            </div>
        </div>
    );
};

export default Profile;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\pages\Auth\Register.jsx ===

import React, { useState } from "react";
import axios from "axios";
import { useNavigate } from "react-router-dom";

const Register = () => {
    const [form, setForm] = useState({
        name: "",
        email: "",
        password: "",
        role: "CUSTOMER", // mặc định là khách hàng
    });

    const [loading, setLoading] = useState(false);
    const [message, setMessage] = useState("");
    const navigate = useNavigate();

    // Xử lý khi người dùng nhập vào input
    const handleChange = (e) => {
        setForm({ ...form, [e.target.name]: e.target.value });
    };

    // Xử lý khi nhấn nút Đăng ký
    const handleSubmit = async (e) => {
        e.preventDefault();
        setLoading(true);
        setMessage("");

        try {
            const res = await axios.post("http://localhost:8080/api/auth/register", form);
            const data = res.data;

            // ✅ Nếu BE trả về token thì coi như đăng ký thành công
            if (data.token) {
                // Lưu token tạm thời (có thể dùng cho auto-login)
                localStorage.setItem("token", data.token);
                localStorage.setItem("userRole", data.role);
                localStorage.setItem("userEmail", data.email);

                setMessage("✅ Đăng ký thành công! Hệ thống sẽ chuyển hướng đến trang đăng nhập...");
                setTimeout(() => navigate("/login"), 1500);
            } else {
                setMessage("❌ Đăng ký thất bại. Vui lòng thử lại!");
            }
        } catch (err) {
            console.error("Register error:", err.response?.data || err.message);
            setMessage(err.response?.data?.message || "❌ Đăng ký thất bại, vui lòng thử lại.");
        } finally {
            setLoading(false);
        }
    };

    return (
        <div className="flex items-center justify-center min-h-screen bg-green-100">
            <form
                onSubmit={handleSubmit}
                className="bg-white p-8 rounded-2xl shadow-lg w-full max-w-md"
            >
                <h2 className="text-2xl font-bold text-center mb-6 text-black-700">
                    Đăng ký tài khoản
                </h2>

                {/* Thông báo */}
                {message && (
                    <p
                        className={`mb-4 text-center ${message.includes("thành công") ? "text-green-600" : "text-red-500"
                            }`}
                    >
                        {message}
                    </p>
                )}

                {/* Họ tên */}
                <input
                    type="text"
                    name="name"
                    placeholder="Họ và tên"
                    value={form.name}
                    onChange={handleChange}
                    className="w-full px-4 py-2 mb-4 border rounded-lg focus:outline-none focus:ring focus:ring-green-400"
                    required
                />

                {/* Email */}
                <input
                    type="email"
                    name="email"
                    placeholder="Email"
                    value={form.email}
                    onChange={handleChange}
                    className="w-full px-4 py-2 mb-4 border rounded-lg focus:outline-none focus:ring focus:ring-green-400"
                    required
                />

                {/* Mật khẩu */}
                <input
                    type="password"
                    name="password"
                    placeholder="Mật khẩu"
                    value={form.password}
                    onChange={handleChange}
                    className="w-full px-4 py-2 mb-4 border rounded-lg focus:outline-none focus:ring focus:ring-green-400"
                    required
                />

                {/* Role */}
                <select
                    name="role"
                    value={form.role}
                    onChange={handleChange}
                    className="w-full px-4 py-2 mb-6 border rounded-lg focus:outline-none focus:ring focus:ring-green-400"
                    required
                >
                    <option value="CUSTOMER">Khách hàng</option>
                    <option value="STAFF">Nhân viên</option>
                    <option value="ADMIN">Quản trị viên</option>
                    <option value="GUEST">Khách</option>
                </select>

                {/* Nút đăng ký */}
                <button
                    type="submit"
                    disabled={loading}
                    className={`w-full mt-6 py-3 rounded-lg font-bold text-white text-lg 
                transition-all duration-300 shadow-md
                ${loading
                            ? "bg-gray-400 cursor-not-allowed opacity-70"
                            : "bg-yellow-500 hover:bg-blue-600 active:bg-blue-700"
                        }`}
                >
                    {loading ? "Đang đăng ký..." : "Đăng ký"}
                </button>

                <div className="flex justify-center mt-4">
                    <button
                        type="button"
                        onClick={() => navigate("/login")}
                        className="text-sm text-black-600 hover:underline"
                    >
                        Đã có tài khoản? Đăng nhập
                    </button>
                </div>
            </form>
        </div>
    );
};

export default Register;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\pages\Auth\ResetPassword.jsx ===

import React, { useState } from "react";
import axios from "axios";
import { useNavigate } from "react-router-dom";

const ResetPassword = () => {
    const [form, setForm] = useState({
        email: "",
        otp: "",
        newPassword: "",
        confirmPassword: "",
    });
    const [loading, setLoading] = useState(false);
    const [message, setMessage] = useState("");

    const navigate = useNavigate();

    const handleChange = (e) => {
        setForm({ ...form, [e.target.name]: e.target.value });
    };

    const handleSubmit = async (e) => {
        e.preventDefault();
        setMessage("");

        if (form.newPassword !== form.confirmPassword) {
            setMessage("❌ Mật khẩu mới và xác nhận mật khẩu không khớp!");
            return;
        }

        setLoading(true);

        try {
            const res = await axios.post("http://localhost:8080/api/auth/reset-password", {
                email: form.email,
                otp_code: form.otp,
                new_password: form.newPassword,
            });

            if (res.data.success) {
                setMessage("✅ Đặt lại mật khẩu thành công! Chuyển về trang đăng nhập...");
                setTimeout(() => {
                    navigate("/login");
                }, 2000);
            } else {
                setMessage(res.data.message || "❌ Đặt lại mật khẩu thất bại!");
            }
        } catch (err) {
            setMessage(err.response?.data?.message || "❌ Lỗi kết nối server!");
        } finally {
            setLoading(false);
        }
    };

    return (
        <div className="flex items-center justify-center min-h-screen bg-gray-100">
            <form
                onSubmit={handleSubmit}
                className="bg-white p-8 rounded-2xl shadow-lg w-full max-w-md"
            >
                <h2 className="text-2xl font-bold text-center mb-6">Reset Password</h2>

                {message && (
                    <p
                        className={`mb-4 text-center font-medium ${message.includes("✅") ? "text-black-600" : "text-red-500"
                            }`}
                    >
                        {message}
                    </p>
                )}

                <input
                    type="email"
                    name="email"
                    placeholder="Email"
                    value={form.email}
                    onChange={handleChange}
                    required
                    className="w-full px-4 py-2 mb-4 border rounded-lg focus:outline-none focus:ring focus:ring-blue-400"
                />
                <input
                    type="text"
                    name="otp"
                    placeholder="OTP"
                    value={form.otp}
                    onChange={handleChange}
                    required
                    className="w-full px-4 py-2 mb-4 border rounded-lg focus:outline-none focus:ring focus:ring-blue-400"
                />
                <input
                    type="password"
                    name="newPassword"
                    placeholder="New Password"
                    value={form.newPassword}
                    onChange={handleChange}
                    required
                    className="w-full px-4 py-2 mb-4 border rounded-lg focus:outline-none focus:ring focus:ring-blue-400"
                />
                <input
                    type="password"
                    name="confirmPassword"
                    placeholder="Confirm Password"
                    value={form.confirmPassword}
                    onChange={handleChange}
                    required
                    className="w-full px-4 py-2 mb-6 border rounded-lg focus:outline-none focus:ring focus:ring-blue-400"
                />

                <button
                    type="submit"
                    disabled={loading}
                    className="w-full bg-black-500 text-white py-2 rounded-lg hover:bg-green-600 transition"
                >
                    {loading ? "Đang xử lý..." : "Reset Password"}
                </button>
            </form>
        </div>
    );
};

export default ResetPassword;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\pages\Auth\VerifyOTP.jsx ===

import { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";

function VerifyOTP() {
    const [email, setEmail] = useState("");
    const [otp, setOtp] = useState("");
    const [message, setMessage] = useState("");
    const [loading, setLoading] = useState(false);
    const navigate = useNavigate();

    useEffect(() => {
        const savedEmail = localStorage.getItem("email");
        if (savedEmail) setEmail(savedEmail);
    }, []);

    const handleVerify = async (e) => {
        e.preventDefault();
        setLoading(true);
        setMessage("");
        try {
            const res = await fetch("http://localhost:3000/api/auth/verify-otp", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email, otp_code: otp }),
            });
            const data = await res.json();
            if (data.success) {
                setMessage("✅ Xác thực thành công! Vui lòng đăng nhập.");
                setTimeout(() => {
                    navigate("/login");
                }, 1000);
            } else {
                setMessage(data.message || "❌ Xác thực thất bại!");
            }
        } catch (err) {
            setMessage("❌ Lỗi kết nối server!");
        } finally {
            setLoading(false);
        }
    };

    return (
        <div className="flex items-center justify-center min-h-screen bg-gradient-to-r from-green-100 via-white to-green-100">
            <form
                onSubmit={handleVerify}
                className="bg-white p-10 rounded-3xl shadow-xl w-full max-w-md border border-gray-200"
            >
                <h2 className="text-3xl font-bold text-center mb-8 text-green-700">Xác thực OTP</h2>

                {message && (
                    <p
                        className={`mb-6 text-center font-medium ${message.includes("thành công") ? "text-green-600" : "text-red-500"
                            }`}
                    >
                        {message}
                    </p>
                )}

                <input
                    type="email"
                    placeholder="Nhập email đăng ký"
                    value={email}
                    onChange={(e) => setEmail(e.target.value)}
                    required
                    className="w-full px-5 py-3 mb-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-400 transition"
                />
                <input
                    type="text"
                    placeholder="Nhập mã OTP"
                    value={otp}
                    onChange={(e) => setOtp(e.target.value)}
                    required
                    className="w-full px-5 py-3 mb-6 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-400 transition"
                />

                <button
                    type="submit"
                    disabled={loading}
                    className="w-full bg-green-600 text-white py-3 rounded-xl hover:bg-green-700 transition font-semibold"
                >
                    {loading ? "Đang xác thực..." : "Xác thực"}
                </button>
            </form>
        </div>
    );
}

export default VerifyOTP;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\pages\Combo\ComboList.jsx ===

import { useEffect, useState } from "react";
import axios from "axios";
import Header from "../../components/layout/Header";
import ComboCard from "../../components/Combo/ComboCard";

export default function ComboList() {
    const [combos, setCombos] = useState([]);
    const [quantities, setQuantities] = useState({});
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);

    useEffect(() => {
        console.log("Bắt đầu gọi API combos...");
        const fetchCombos = async () => {
            try {
                const res = await axios.get("http://localhost:8080/api/combos");
                setCombos(res.data);
            } catch (err) {
                setError("Không thể tải danh sách combo");
            } finally {
                setLoading(false);
            }
        };
        fetchCombos();
    }, []);

    const handleQuantityChange = (id, qty) => {
        setQuantities((prev) => ({ ...prev, [id]: qty }));
    };

    if (loading) return <p className="text-center text-lg">Đang tải...</p>;
    if (error) return <p className="text-center text-red-600">{error}</p>;

    return (
        <>
            <Header />
            <div className="p-6 max-w-6xl mx-auto bg-gradient-to-b from-[#0A0F2C] to-[#2B1E5A] min-h-screen text-white">
                <h1 className="text-3xl font-bold mb-6 text-center">Danh Sách Combo</h1>

                {/* Summary Bar */}
                <div className="bg-[#0B122E] p-5 rounded-xl flex justify-between items-center mb-6 border border-white/10">
                    <div>
                        <h2 className="text-xl font-bold">Tạm tính</h2>
                        <p className="text-gray-300">Tổng tiền combo bạn chọn</p>
                    </div>
                    <div className="text-right">
                        <p className="text-2xl font-bold text-white">
                            {Object.keys(quantities)
                                .reduce((total, id) => {
                                    const combo = combos.find((c) => c.comboID == id);
                                    const price = combo?.price || 0;
                                    return total + price * (quantities[id] || 0);
                                }, 0)
                                .toLocaleString()}{" "}
                            VND
                        </p>
                        <button className="mt-2 px-6 py-2 border rounded-lg hover:bg-white/10">
                            THANH TOÁN
                        </button>
                    </div>
                </div>


                {/* Combo List */}
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {combos
                        .filter(combo => combo && combo.comboID) // Lọc combo hợp lệ
                        .map((combo) => (
                            <ComboCard
                                key={combo.comboID}
                                combo={combo}
                                onQuantityChange={handleQuantityChange}
                            />
                        ))}
                </div>
            </div>
        </>
    );
}


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\pages\Home\Home.jsx ===

// Home.jsx
import React, { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import Header from "../../components/layout/Header";
import Footer from "../../components/layout/Footer";
import Sidebar from "../../components/layout/Sidebar";
import Dashboard from "../../components/Dashboard/Dashboard";
import MovieManagement from "../../components/Movie/MovieManagement";
import RoomManagement from "../../components/Room/RoomManagement";

const Home = () => {
    const [user, setUser] = useState(null);
    const [activeTab, setActiveTab] = useState('dashboard');
    const [isSidebarOpen, setIsSidebarOpen] = useState(false);
    const navigate = useNavigate();

    useEffect(() => {
        const storedUser = localStorage.getItem("user");
        if (storedUser) {
            setUser(JSON.parse(storedUser));
        }
    }, []);

    const handleLogout = () => {
        localStorage.removeItem("user");
        localStorage.removeItem("token");
        setUser(null);
        navigate("/");
    };

    const toggleSidebar = () => {
        setIsSidebarOpen(!isSidebarOpen);
    };

    const renderContent = () => {
        switch (activeTab) {
            case 'dashboard':
                return <Dashboard />;
            case 'movies':
                return <MovieManagement />;
            case 'rooms':
                return <RoomManagement />;
            case 'showtimes':
                return (
                    <div className="p-6">
                        <h1 className="text-3xl font-bold text-gray-800 mb-4">Quản Lý Lịch Chiếu</h1>
                        <p className="text-gray-600">Tính năng đang được phát triển...</p>
                    </div>
                );
            case 'users':
                return (
                    <div className="p-6">
                        <h1 className="text-3xl font-bold text-gray-800 mb-4">Quản Lý Người Dùng</h1>
                        <p className="text-gray-600">Tính năng đang được phát triển...</p>
                    </div>
                );
            case 'reports':
                return (
                    <div className="p-6">
                        <h1 className="text-3xl font-bold text-gray-800 mb-4">Báo Cáo & Thống Kê</h1>
                        <p className="text-gray-600">Tính năng đang được phát triển...</p>
                    </div>
                );
            case 'settings':
                return (
                    <div className="p-6">
                        <h1 className="text-3xl font-bold text-gray-800 mb-4">Cài Đặt Hệ Thống</h1>
                        <p className="text-gray-600">Tính năng đang được phát triển...</p>
                    </div>
                );
            default:
                return <Dashboard />;
        }
    };

    return (
        <div className="min-h-screen bg-gray-50 flex">
            {/* Sidebar */}
            <Sidebar
                activeTab={activeTab}
                setActiveTab={setActiveTab}
                isOpen={isSidebarOpen}
            />

            {/* Main Content */}
            <div className="flex-1 flex flex-col lg:ml-0">
                {/* Header */}
                <Header
                    user={user}
                    handleLogout={handleLogout}
                    onMenuToggle={toggleSidebar}
                    isSidebarOpen={isSidebarOpen}
                />

                {/* Main Content Area */}
                <main className="flex-1 overflow-auto">
                    {renderContent()}
                </main>

                {/* Footer */}
                <Footer />
            </div>

            {/* Overlay for mobile */}
            {isSidebarOpen && (
                <div
                    className="fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden"
                    onClick={() => setIsSidebarOpen(false)}
                />
            )}
        </div>
    );
};

export default Home;

================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\services\api.js ===

import axios from "axios";

const API_BASE_URL = "http://localhost:3000/api"; // backend chạy ở cổng 3000 + prefix /api

export const apiRequest = async (endpoint, method = "GET", body = null, token = null) => {
  const headers = { "Content-Type": "application/json" };
  if (token) headers["Authorization"] = `Bearer ${token}`;

  const res = await fetch(`${API_BASE_URL}${endpoint}`, {
    method,
    headers,
    body: body ? JSON.stringify(body) : null,
  });

  const data = await res.json();
  if (!res.ok) {
    throw new Error(data.message || "Something went wrong");
  }

  return data;
};

// API functions for products
export const getProducts = async (page = 1, limit = 12, filters = {}) => {
  const params = new URLSearchParams({
    page: page.toString(),
    limit: limit.toString(),
    ...filters
  });

  const response = await fetch(`${API_BASE_URL}/products?${params}`);
  const data = await response.json();
  
  if (!response.ok) {
    throw new Error(data.message || "Failed to fetch products");
  }
  
  return data;
};

export const searchProducts = async (query, page = 1, limit = 12) => {
  const params = new URLSearchParams({
    q: query,
    page: page.toString(),
    limit: limit.toString()
  });

  const response = await fetch(`${API_BASE_URL}/products/search?${params}`);
  const data = await response.json();
  
  if (!response.ok) {
    throw new Error(data.message || "Failed to search products");
  }
  
  return data;
};

export const getHomeData = async () => {
  const response = await fetch(`${API_BASE_URL}/products/home`);
  const data = await response.json();
  
  if (!response.ok) {
    throw new Error(data.message || "Failed to fetch home data");
  }
  
  return data;
};


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\services\cart\CartSlice.js ===

import { createSlice, createAsyncThunk } from "@reduxjs/toolkit";
import axiosClient from "../../services/axiosClient";

// Lấy giỏ hàng
export const fetchCart = createAsyncThunk("cart/fetchCart", async () => {
  const res = await axiosClient.get("/cart");
  return res;
});

// Thêm sản phẩm vào giỏ
export const addToCart = createAsyncThunk(
  "cart/addToCart",
  async (product) => {
    const res = await axiosClient.post("/cart", {
      productId: product.id,
      quantity: 1,
    });
    return res;
  }
);

// Cập nhật số lượng
export const updateCart = createAsyncThunk(
  "cart/updateCart",
  async ({ itemId, quantity }) => {
    const res = await axiosClient.put(`/cart/${itemId}`, { quantity });
    return res;
  }
);

// Xóa sản phẩm
export const removeFromCart = createAsyncThunk(
  "cart/removeFromCart",
  async (itemId) => {
    await axiosClient.delete(`/cart/${itemId}`);
    return itemId;
  }
);

const cartSlice = createSlice({
  name: "cart",
  initialState: {
    items: [],
    status: "idle",
    error: null,
  },
  reducers: {},
  extraReducers: (builder) => {
    builder
      .addCase(fetchCart.pending, (state) => {
        state.status = "loading";
      })
      .addCase(fetchCart.fulfilled, (state, action) => {
        state.status = "succeeded";
        state.items = action.payload;
      })
      .addCase(addToCart.fulfilled, (state, action) => {
        state.items.push(action.payload);
      })
      .addCase(updateCart.fulfilled, (state, action) => {
        const index = state.items.findIndex(
          (item) => item.id === action.payload.id
        );
        if (index !== -1) {
          state.items[index] = action.payload;
        }
      })
      .addCase(removeFromCart.fulfilled, (state, action) => {
        state.items = state.items.filter((item) => item.id !== action.payload);
      });
  },
});

export default cartSlice.reducer;


================================================================================

=== D:\TieuLuan\Do_An\FE_Admin\src\utils\getImagePath.js ===

export const getImagePath = (path) => {
  if (!path) return "/images/dt1.jpg"; 
  return path.startsWith("images/") ? `/${path}` : `/images/${path}`;
};


================================================================================

